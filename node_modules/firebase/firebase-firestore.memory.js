!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(df){"use strict";try{(function(){df=df&&Object.prototype.hasOwnProperty.call(df,"default")?df.default:df;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function y(n,r){var i,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},a=p.INFO,u=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,m=(n(f,l=Error),f);function f(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g;function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=N||{},_=A||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function R(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),P=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function k(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:k).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,O)&&t[O]||(t[O]=++P);var t},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var X=_.navigator;if(X){var Q=X.userAgent;if(Q){H=Q;break t}}H=""}function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=Y(H,"Opera"),ot=Y(H,"Trident")||Y(H,"MSIE"),st=Y(H,"Edge"),at=st||ot,ut=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ht=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ct(){var t=_.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=H,ut?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt,yt={};function vt(a){return t=a,e=function(){for(var t=0,e=z(String(nt)).split("."),n=z(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(_.document&&ot){var gt=ct();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!vt("9"),Et=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",S,e),_.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},x(Tt,It);var At={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++_t,this.V=this.X=!1}function Dt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Rt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=j(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Vt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Bt(r);return e&&e[Nt]?e.sa(n,r,L(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Nt]?t.ra(e,n,L(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!wt)return null;var a,u,h=jt(t);if(h||(t[Pt]=h=new Rt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=wt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[Nt])Lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Dt(t)}}}function Mt(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function xt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Ut(t),n.call(r,e)}function Ft(t,e){if(t.V)return!0;if(wt)return xt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new Tt(e,this))}function jt(t){return(t=t[Pt])instanceof Rt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==D(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Gt(){F.call(this),this.c=new Rt(this),(this.J=this).A=null}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var a=s.listener,u=s.aa||s.src;s.X&&Lt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}x(Gt,F),Gt.prototype[Nt]=!0,(T=Gt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Bt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new It(t,n);else if(t instanceof It)t.target=t.target||n;else{var i=t;tt(t=new It(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Wt(s,r,!0,t)&&i}if(i=Wt(s=t.a=n,r,!0,t)&&i,i=Wt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Wt(s=t.a=e[o],r,!1,t)&&i;return i},T.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=_.JSON.stringify;function zt(){this.b=this.a=null}var Yt,$t=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Qt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Kt(t){_.setTimeout(function(){throw t},0)}function Jt(t,e){var n;Yt||(n=_.Promise.resolve(void 0),Yt=function(){n.then(ee)}),Zt||(Yt(),Zt=!0),te.add(t,e)}zt.prototype.add=function(t,e){var n=$t.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new zt;function ee(){for(var t;r=n=void 0,r=null,(n=te).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Kt(t)}var e=$t;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,r;Zt=!1}function ne(t,e){Gt.call(this),this.b=t||1,this.a=e||_,this.f=C(this.Ua,this),this.g=M()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function oe(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function se(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function ae(t){F.call(this),this.b=t,this.a={}}x(ne,Gt),(T=ne.prototype).Z=!1,T.L=null,T.Ua=function(){if(this.Z){var t=M()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start()))}},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=M())},T.C=function(){ne.M.C.call(this),re(this),delete this.a},x(oe,F),(T=oe.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},T.C=function(){oe.M.C.call(this),this.T&&(_.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},x(ae,F);var ue=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function le(){}ae.prototype.C=function(){ae.M.C.call(this),ce(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fe=null;function pe(){return fe=fe||new Gt}function de(t){It.call(this,"serverreachability",t)}function ye(t){var e=pe();e.dispatchEvent(new de(e))}function ve(t){It.call(this,"statevent",t)}function ge(t){var e=pe();e.dispatchEvent(new ve(e))}function me(t){It.call(this,"timingevent",t)}function we(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}x(de,It),x(ve,It),x(me,It);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){It.call(this,"d")}function De(){It.call(this,"c")}function Re(){}function Le(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ae(this),this.N=Oe,t=at?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}x(Se,It),x(De,It),x(Re,Ie),Ne=new Re;var Oe=45e3,Pe={},Ve={};function ke(t,e,n){t.B=1,t.f=nn(Qe(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=M(),xe(t),t.A=Qe(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.w=0,t.a=ar(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(C(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?J(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye(1)}function Ue(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=Me(t,n);if(i==Ve){4==e&&(t.c=4,ge(14),r=!1);break}if(i==Pe){t.c=4,ge(15),r=!1;break}Ge(t,i)}4==e&&0==n.length&&(t.c=1,ge(16),r=!1),t.b=t.b&&r,r||(Be(t),qe(t))}function Me(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?Ve:(n=Number(e.substring(n,r)),isNaN(n)?Pe:(r+=1)+n>e.length?Ve:(e=e.substr(r,n),t.w=r+n,e))}function xe(t){t.P=M()+t.N,Fe(t,t.N)}function Fe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(C(t.Qa,t),e)}function je(t){t.h&&(_.clearTimeout(t.h),t.h=null)}function qe(t){0==t.g.u||t.l||nr(t.g,t)}function Be(t){je(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Ge(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||Tn(n.b,t)))if(n.A=t.H,!t.o&&Tn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;er(n),n.a.cancel(),n.a=null}tr(n),ge(18)}}else n.ia=i[1],0<n.ia-n.G&&i[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=we(C(n.Na,n),6e3));if(In(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else ir(n,11)}else if(!t.o&&n.a!=t||er(n),!W(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var a=n,u=t.a;if(u){var h=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=a.b;!c.a&&(Y(h,"spdy")||Y(h,"quic")||Y(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(An(c,c.b),c.b=null))}if(a.s){var l=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.ha=l,en(a.v,a.s,l))}}n.u=3,n.c&&n.c.na();var f=t;if((a=n).ea=sr(a,a.w?a.R:null,a.P),f.o){Nn(a.b,f);var p=f,d=a.D;d&&p.setTimeout(d),p.h&&(je(p),xe(p)),a.a=f}else Zn(a);0<n.f.length&&Xn(n)}else"stop"!=i[0]&&"close"!=i[0]||ir(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ir(n,7):zn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);ye(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Le.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Bn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.qa(),r=this.a.S();if(!(e<3||3==e&&!at&&!this.a.Y())){this.l||4!=e||7==n||ye(8==n||r<=0?3:2),je(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.c=3,ge(12),Be(this),qe(this);break t}this.o=!0,Ge(this,u)}this.F?(Ue(this,e,o),at&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Ge(this,o),4==e&&Be(this),this.b&&!this.l&&(4==e?nr(this.g,this):(this.b=!1,xe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,ge(12)):(this.c=0,ge(13)),Be(this),qe(this)}}}catch(t){}},T.Ra=function(){if(this.a){var t=Bn(this.a),e=this.a.Y();this.w<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&xe(this))}},T.cancel=function(){this.l=!0,Be(this)},T.Qa=function(){this.h=null;var t=M();0<=t-this.P?(2!=this.B&&(ye(3),ge(17)),Be(this),this.c=2,qe(this)):Fe(this,this.P-t)},(T=He.prototype).I=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return ze(this),this.a.concat()},T.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},T.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe){this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b;var n=new fn;n.c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i}else t&&(n=String(t).match($e))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Qe(t){return new Xe(t)}function Ke(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,an,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var an=/[#\/\?@]/g,un=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function yn(t,e){return pn(t),e=gn(t,e),Ye(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ca&&_.ca.ua&&_.ca.ua()&&_.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){pn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=B(e,this.a.get(gn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function Dn(){this.a=new Sn}function Rn(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;L(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var On=_.JSON.parse;function Pn(t){Gt.call(this),this.headers=new He,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Vn,this.B=this.F=!1}x(Pn,Gt);var Vn="",kn=/^https?$/i,Cn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),jn(t)}function xn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==N&&(!t.s[1]||4!=Bn(t)||2!=t.S()))if(t.l&&4==Bn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match($e)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}i=!kn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Bn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.S()+"]",xn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Wn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Wn("baseRetryDelayMs",5e3,t),this.Ga=Wn("retryDelaySeedMs",1e4,t),this.Da=Wn("forwardChannelMaxRetries",2,t),this.ga=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new wn(t&&t.concurrentRequestLimit),this.ja=new Dn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function zn(t){if(Yn(t),3==t.u){var e=t.H++,n=Qe(t.v);en(n,"SID",t.B),en(n,"RID",e),en(n,"TYPE","terminate"),Kn(t,n),(e=new Le(t,e,void 0)).B=2,e.f=nn(Qe(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=ar(e.g,null),e.a.$(e.f)),e.s=M(),xe(e)}or(t)}function Yn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(_.clearTimeout(t.i),t.i=null),er(t),t.b.cancel(),t.g&&("number"==typeof t.g&&_.clearTimeout(t.g),t.g=null)}function $n(t,e){t.f.push(new mn(t.Fa++,e)),3==t.u&&Xn(t)}function Xn(t){En(t.b)||t.g||(t.g=!0,Jt(t.xa,t),t.o=0)}function Qn(t,e){var n;n=e?e.W:t.H++;var r=Qe(t.v);en(r,"SID",t.B),en(r,"RID",n),en(r,"AID",t.G),Kn(t,r),t.h&&t.j&&Gn(r,t.h,t.j),n=new Le(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),An(t.b,n),ke(n,r,e)}function Kn(t,n){t.c&&We({},function(t,e){en(n,e,t)})}function Jn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{Rn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Zn(t){t.a||t.i||(t.J=1,Jt(t.wa,t),t.m=0)}function tr(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(C(t.wa,t),rr(t,t.m)),t.m++,1)}function er(t){null!=t.l&&(_.clearTimeout(t.l),t.l=null)}function nr(t,e){var n=null;if(t.a==e){er(t),t.a=null;var r=2}else{if(!Tn(t.b,e))return;n=e.i,Nn(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=M()-e.s;var i=t.o;(r=pe()).dispatchEvent(new me(r)),Xn(t)}else Zn(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){if(!(In(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(C(t.xa,t,e),rr(t,t.o)),t.o++,1}}(t,e)||2==r&&tr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ir(t,e){if(2==e){var n=null;t.c&&(n=null);var r=C(t.Ta,t);n||(n=new Xe("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||Ke(n,"https"),nn(n)),function(t,e){var n=new le;if(_.Image){var r=new Image;r.onload=U(Ln,n,r,"TestLoadImage: loaded",!0,e),r.onerror=U(Ln,n,r,"TestLoadImage: error",!1,e),r.onabort=U(Ln,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=U(Ln,n,r,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ge(2);t.u=0,t.c&&t.c.la(e),or(t),Yn(t)}function or(t){t.u=0,t.A=-1,t.c&&(0==_n(t.b).length&&0==t.f.length||(t.b.c.length=0,G(t.f),t.f.length=0),t.c.ka())}function sr(t,e,n){var r,i,o,s,a,u,h=(r=n)instanceof Xe?Qe(r):new Xe(r,void 0);if(""!=h.c)e&&Je(h,e+"."+h.c),Ze(h,h.h);else{var c=_.location;i=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,a=n,u=new Xe(null,void 0),i&&Ke(u,i),o&&Je(u,o),s&&Ze(u,s),a&&(u.g=a),h=u}return t.N&&K(t.N,function(t,e){en(h,e,t)}),e=t.s,n=t.ha,e&&n&&en(h,e,n),en(h,"VER",t.oa),Kn(t,h),h}function ar(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ea)).F=t.w,e}function ur(){}function hr(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function cr(t,e){Gt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){De.call(this),this.status=1}function pr(t){this.a=t}(T=Pn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Te(this.G):Te(Ne),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Mn(this,t)}t=n||"";var i,o=new He(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=j(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.B=(i=this.a,ot&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},T.ta=function(){void 0!==N&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Pn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Fn(this):this.Oa())},T.Oa=function(){Fn(this)},T.S=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Hn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Le(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=J(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),en(i=Qe(this.v),"RID",t),en(i,"CVER",22),this.s&&en(i,"X-HTTP-Session-Id",this.s),Kn(this,i),this.h&&r&&Gn(i,this.h,r),An(this.b,n),this.fa?(en(i,"$req",e),en(i,"SID","null"),n.R=!0,ke(n,i,null)):ke(n,i,e),this.u=2}}else 3==this.u&&(t?Qn(this,t):0==this.f.length||En(this.b)||Qn(this))},T.wa=function(){this.i=null,this.a=new Le(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Qe(this.ea);en(t,"RID","rpc"),en(t,"SID",this.B),en(t,"CI",this.U?"0":"1"),en(t,"AID",this.G),Kn(this,t),en(t,"TYPE","xmlhttp"),this.h&&this.j&&Gn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=nn(Qe(t)),e.j=null,e.F=!0,Ce(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,tr(this),ge(19))},T.Ta=function(t){ge(t?2:1)},(T=ur.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},x(cr,Gt),(T=cr.prototype).addEventListener=function(t,e,n,r){cr.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){cr.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(0),t.P=e,t.N=n||{},t.U=t.W,t.v=sr(t,null,t.P),Xn(t)},T.close=function(){zn(this.a)},T.La=function(t){if("string"==typeof t){var e={};e.__data__=t,$n(this.a,e)}else this.g?((e={}).__data__=Ht(t),$n(this.a,e)):$n(this.a,t)},T.C=function(){this.a.c=null,delete this.f,zn(this.a),delete this.a,cr.M.C.call(this)},x(lr,Se),x(fr,De),x(pr,ur),pr.prototype.na=function(){this.a.dispatchEvent("a")},pr.prototype.ma=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.la=function(t){this.a.dispatchEvent(new fr)},pr.prototype.ka=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.La,cr.prototype.open=cr.prototype.Ka,cr.prototype.close=cr.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,Pn.prototype.listenOnce=Pn.prototype.sa,Pn.prototype.getLastError=Pn.prototype.Ma,Pn.prototype.getLastErrorCode=Pn.prototype.qa,Pn.prototype.getStatus=Pn.prototype.S,Pn.prototype.getResponseJson=Pn.prototype.Ja,Pn.prototype.getResponseText=Pn.prototype.Y,Pn.prototype.send=Pn.prototype.$;var dr={createWebChannelTransport:function(){return new hr},ErrorCode:be,EventType:Ee,WebChannel:Ae,XhrIo:Pn},yr=dr.createWebChannelTransport,vr=dr.ErrorCode,gr=dr.EventType,mr=dr.WebChannel,wr=dr.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir=df.SDK_VERSION,Tr=new h("@firebase/firestore");function Ar(){return Tr.logLevel}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Tr.logLevel<=p.DEBUG){var r=e.map(Sr);Tr.debug.apply(Tr,v(["Firestore ("+Ir+"): "+t],r))}}function _r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Tr.logLevel<=p.ERROR){var r=e.map(Sr);Tr.error.apply(Tr,v(["Firestore ("+Ir+"): "+t],r))}}function Sr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Dr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Ir+") INTERNAL ASSERTION FAILED: "+t;throw _r(e),new Error(e)}function Rr(t){t||Dr()}function Lr(t){return t}function Or(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Pr=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Or(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function kr(t,e){return t<e?-1:e<t?1:0}function Cr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ur(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Mr=(Object.defineProperty(xr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),xr.prototype.isEqual=function(t){return t instanceof xr&&t.projectId===this.projectId&&t.database===this.database},xr.prototype.o=function(t){return kr(this.projectId,t.projectId)||kr(this.database,t.database)},xr);function xr(t,e){this.projectId=t,this.database=e||"(default)"}function Fr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Br,Gr,Wr,Hr=(ui.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.u(s,t))return a}},ui.prototype.has=function(t){return void 0!==this.get(t)},ui.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},ui.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},ui.prototype.forEach=function(a){jr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},ui.prototype._=function(){return qr(this.l)},ui),zr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=(n(ai,Wr=Error),ai),$r=(si.now=function(){return si.fromMillis(Date.now())},si.fromDate=function(t){return si.fromMillis(t.getTime())},si.fromMillis=function(t){var e=Math.floor(t/1e3);return new si(e,1e6*(t-1e3*e))},si.prototype.toDate=function(){return new Date(this.toMillis())},si.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},si.prototype.T=function(t){return this.seconds===t.seconds?kr(this.nanoseconds,t.nanoseconds):kr(this.seconds,t.seconds)},si.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},si.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},si.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},si),Xr=(oi.m=function(t){return new oi(t)},oi.min=function(){return new oi(new $r(0,0))},oi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},oi.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},oi.prototype.A=function(){return this.timestamp},oi),Qr=(Object.defineProperty(ii.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ii.prototype.isEqual=function(t){return 0===ii.P(this,t)},ii.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ii?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ii.prototype.limit=function(){return this.offset+this.length},ii.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ii.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ii.prototype.v=function(){return this.segments[this.offset]},ii.prototype.S=function(){return this.get(this.length-1)},ii.prototype.get=function(t){return this.segments[this.offset+t]},ii.prototype._=function(){return 0===this.length},ii.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ii.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ii.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ii),Kr=(n(ri,Gr=Qr),ri.prototype.V=function(t,e,n){return new ri(t,e,n)},ri.prototype.$=function(){return this.F().join("/")},ri.prototype.toString=function(){return this.$()},ri.N=function(t){if(0<=t.indexOf("//"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ri(t.split("/").filter(function(t){return 0<t.length}))},ri.k=function(){return new ri([])},ri),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Zr=(n(ni,Br=Qr),ni.prototype.V=function(t,e,n){return new ni(t,e,n)},ni.O=function(t){return Jr.test(t)},ni.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ni.O(t)||(t="`"+t+"`"),t}).join(".")},ni.prototype.toString=function(){return this.$()},ni.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},ni.M=function(){return new ni(["__name__"])},ni.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Yr(zr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Yr(zr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Yr(zr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ni(e)},ni.k=function(){return new ni([])},ni),ti=(ei.U=function(t){return new ei(Kr.N(t).p(5))},ei.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ei.prototype.isEqual=function(t){return null!==t&&0===Kr.P(this.path,t.path)},ei.prototype.toString=function(){return this.path.toString()},ei.P=function(t,e){return Kr.P(t.path,e.path)},ei.W=function(t){return t.length%2==0},ei.j=function(t){return new ei(new Kr(t.slice()))},ei);function ei(t){this.path=t}function ni(){return null!==Br&&Br.apply(this,arguments)||this}function ri(){return null!==Gr&&Gr.apply(this,arguments)||this}function ii(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.R=n}function oi(t){this.timestamp=t}function si(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yr(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ai(t,e){var n=this;return(n=Wr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ui(t,e){this.h=t,this.u=e,this.l={}}function hi(t){return null==t}function ci(t){return-0===t&&1/t==-1/0}var li=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new li(t,e,n,r,i,o,s)}function pi(t){var e=Lr(t);if(null===e.G){var n=e.path.$();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return(e=t).field.$()+e.op.toString()+bo(e.value);var e}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),hi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=xa(e.startAt)),e.endAt&&(n+="|ub:",n+=xa(e.endAt)),e.G=n}return e.G}function di(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(r=t.orderBy[n],i=e.orderBy[n],r.dir!==i.dir||!r.field.isEqual(i.field))return!1;var r,i,o,s;if(t.filters.length!==e.filters.length)return!1;for(var a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],!(o instanceof ba&&s instanceof ba&&o.op===s.op&&o.field.isEqual(s.field)&&vo(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ja(t.startAt,e.startAt)&&ja(t.endAt,e.endAt)}function yi(t){return ti.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.K,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},gi.prototype.H=function(){return 2*this.K.length},gi.prototype.o=function(t){return kr(this.K,t.K)},gi.prototype.isEqual=function(t){return this.K===t.K},gi);function gi(t){this.K=t}vi.Y=new vi("");function mi(t){this.count=t}var wi,bi,Ei=(Ii.prototype.Z=function(t){return new Ii(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ii.prototype.tt=function(t,e){return new Ii(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ii.prototype.et=function(t){return new Ii(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},Ii);function Ii(t,e,n,r,i,o,s){void 0===i&&(i=Xr.min()),void 0===o&&(o=Xr.min()),void 0===s&&(s=vi.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ti(t){switch(t){case zr.OK:return Dr();case zr.CANCELLED:case zr.UNKNOWN:case zr.DEADLINE_EXCEEDED:case zr.RESOURCE_EXHAUSTED:case zr.INTERNAL:case zr.UNAVAILABLE:case zr.UNAUTHENTICATED:return;case zr.INVALID_ARGUMENT:case zr.NOT_FOUND:case zr.ALREADY_EXISTS:case zr.PERMISSION_DENIED:case zr.FAILED_PRECONDITION:case zr.ABORTED:case zr.OUT_OF_RANGE:case zr.UNIMPLEMENTED:case zr.DATA_LOSS:return 1;default:return Dr()}}function Ai(t){if(void 0===t)return _r("GRPC error has no .code"),zr.UNKNOWN;switch(t){case wi.OK:return zr.OK;case wi.CANCELLED:return zr.CANCELLED;case wi.UNKNOWN:return zr.UNKNOWN;case wi.DEADLINE_EXCEEDED:return zr.DEADLINE_EXCEEDED;case wi.RESOURCE_EXHAUSTED:return zr.RESOURCE_EXHAUSTED;case wi.INTERNAL:return zr.INTERNAL;case wi.UNAVAILABLE:return zr.UNAVAILABLE;case wi.UNAUTHENTICATED:return zr.UNAUTHENTICATED;case wi.INVALID_ARGUMENT:return zr.INVALID_ARGUMENT;case wi.NOT_FOUND:return zr.NOT_FOUND;case wi.ALREADY_EXISTS:return zr.ALREADY_EXISTS;case wi.PERMISSION_DENIED:return zr.PERMISSION_DENIED;case wi.FAILED_PRECONDITION:return zr.FAILED_PRECONDITION;case wi.ABORTED:return zr.ABORTED;case wi.OUT_OF_RANGE:return zr.OUT_OF_RANGE;case wi.UNIMPLEMENTED:return zr.UNIMPLEMENTED;case wi.DATA_LOSS:return zr.DATA_LOSS;default:return Dr()}}(bi=wi=wi||{})[bi.OK=0]="OK",bi[bi.CANCELLED=1]="CANCELLED",bi[bi.UNKNOWN=2]="UNKNOWN",bi[bi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bi[bi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bi[bi.NOT_FOUND=5]="NOT_FOUND",bi[bi.ALREADY_EXISTS=6]="ALREADY_EXISTS",bi[bi.PERMISSION_DENIED=7]="PERMISSION_DENIED",bi[bi.UNAUTHENTICATED=16]="UNAUTHENTICATED",bi[bi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bi[bi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bi[bi.ABORTED=10]="ABORTED",bi[bi.OUT_OF_RANGE=11]="OUT_OF_RANGE",bi[bi.UNIMPLEMENTED=12]="UNIMPLEMENTED",bi[bi.INTERNAL=13]="INTERNAL",bi[bi.UNAVAILABLE=14]="UNAVAILABLE",bi[bi.DATA_LOSS=15]="DATA_LOSS";var Ni=(Li.prototype.nt=function(t,e){return new Li(this.P,this.root.nt(t,e,this.P).copy(null,null,Si.st,null,null))},Li.prototype.remove=function(t){return new Li(this.P,this.root.remove(t,this.P).copy(null,null,Si.st,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype._=function(){return this.root._()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.it=function(){return this.root.it()},Li.prototype.rt=function(){return this.root.rt()},Li.prototype.ot=function(t){return this.root.ot(t)},Li.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.ht=function(t){return this.root.ht(t)},Li.prototype.at=function(){return new _i(this.root,null,this.P,!1)},Li.prototype.ut=function(t){return new _i(this.root,t,this.P,!1)},Li.prototype.ct=function(){return new _i(this.root,null,this.P,!0)},Li.prototype.lt=function(t){return new _i(this.root,t,this.P,!0)},Li),_i=(Ri.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ri.prototype.wt=function(){return 0<this.ft.length},Ri.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ri),Si=(Di.prototype.copy=function(t,e,n,r,i){return new Di(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Di.prototype._=function(){return!1},Di.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Di.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Di.prototype.min=function(){return this.left._()?this:this.left.min()},Di.prototype.it=function(){return this.min().key},Di.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Di.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Di.prototype.It=function(){if(this.left._())return Di.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Di.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Di.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Di.prototype.At=function(){return this.color},Di.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.pt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Di.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).pt()).yt()),t},Di.prototype.Vt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Di.prototype.pt=function(){var t=this.copy(null,null,Di.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Di.prototype.Pt=function(){var t=this.copy(null,null,Di.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Di.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Di.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Di.prototype.vt=function(){if(this.At()&&this.left.At())throw Dr();if(this.right.At())throw Dr();var t=this.left.vt();if(t!==this.right.vt())throw Dr();return t+(this.At()?0:1)},Di);function Di(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Di.RED,this.left=null!=r?r:Di.EMPTY,this.right=null!=i?i:Di.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Li(t,e){this.P=t,this.root=e||Si.EMPTY}function Oi(){this.size=0}Si.EMPTY=null,Si.RED=!0,Si.st=!1,Si.EMPTY=(Object.defineProperty(Oi.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(Oi.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Oi.prototype.copy=function(t,e,n,r,i){return this},Oi.prototype.nt=function(t,e,n){return new Si(t,e)},Oi.prototype.remove=function(t,e){return this},Oi.prototype._=function(){return!0},Oi.prototype.ot=function(t){return!1},Oi.prototype.ht=function(t){return!1},Oi.prototype.it=function(){return null},Oi.prototype.rt=function(){return null},Oi.prototype.At=function(){return!1},Oi.prototype.gt=function(){return!0},Oi.prototype.vt=function(){return 0},new Oi);var Pi=(Ui.prototype.has=function(t){return null!==this.data.get(t)},Ui.prototype.first=function(){return this.data.it()},Ui.prototype.last=function(){return this.data.rt()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ui.prototype.indexOf=function(t){return this.data.indexOf(t)},Ui.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Ui.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Ui.prototype.St=function(t,e){var n;for(n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Ui.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Ui.prototype.at=function(){return new Vi(this.data.at())},Ui.prototype.ut=function(t){return new Vi(this.data.ut(t))},Ui.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Ui.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ui.prototype._=function(){return this.data._()},Ui.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ui.prototype.isEqual=function(t){if(!(t instanceof Ui))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Ui.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ui.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ui.prototype.copy=function(t){var e=new Ui(this.P);return e.data=t,e},Ui),Vi=(Ci.prototype.dt=function(){return this.Ft.dt().key},Ci.prototype.wt=function(){return this.Ft.wt()},Ci),ki=new Ni(ti.P);function Ci(t){this.Ft=t}function Ui(t){this.P=t,this.data=new Ni(this.P)}function Mi(){return ki}function xi(){return Mi()}var Fi=new Ni(ti.P);function ji(){return Fi}var qi=new Ni(ti.P),Bi=new Pi(ti.P);function Gi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Wi=new Pi(kr);function Hi(){return Wi}function zi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Yi(t,e){this.targetId=t,this.ee=e}function $i(t,e,n,r){void 0===n&&(n=vi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Xi=(uo.kt=function(t){return new uo(t.P)},uo.prototype.has=function(t){return null!=this.$t.get(t)},uo.prototype.get=function(t){return this.$t.get(t)},uo.prototype.first=function(){return this.Nt.it()},uo.prototype.last=function(){return this.Nt.rt()},uo.prototype._=function(){return this.Nt._()},uo.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(uo.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),uo.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},uo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},uo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},uo.prototype.copy=function(t,e){var n=new uo;return n.P=this.P,n.$t=t,n.Nt=e,n},uo),Qi=(ao.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Dr()},ao.prototype.Ot=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ao),Ki=(so.Bt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Xi.kt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Mt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Mt.isEqual(t.Mt)&&da(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Ji=(oo.Kt=function(t,e){var n=new Map;return n.set(t,Zi.zt(t,e)),new oo(Xr.min(),n,Hi(),Mi(),Gi())},oo),Zi=(io.zt=function(t,e){return new io(vi.Y,e,Gi(),Gi(),Gi())},io),to=(Object.defineProperty(ro.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),ro.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},ro.prototype.ce=function(){var n=Gi(),r=Gi(),i=Gi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Dr()}}),new Zi(this.ie,this.re,n,r,i)},ro.prototype.le=function(){this.oe=!1,this.se=co()},ro.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},ro.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},ro.prototype.de=function(){this.ne+=1},ro.prototype.we=function(){--this.ne},ro.prototype.Te=function(){this.oe=!0,this.re=!0},ro),eo=(no.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Js?this.Ve(r,t.te):t.te instanceof Zs&&this.pe(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.pe(s,t.key,t.te)}},no.prototype.ye=function(n){var r=this;this.ge(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.be(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Dr()}})},no.prototype.ge=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.be(e)&&n(e)})},no.prototype.Ce=function(t){var e=t.targetId,n=t.ee.count,r=this.De(e);if(r){var i=r.target;if(yi(i))if(0===n){var o=new ti(i.path);this.pe(e,o,new Zs(o,Xr.min()))}else Rr(1===n);else this.Fe(e)!==n&&(this.Se(e),this.Re=this.Re.add(e))}},no.prototype.$e=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n=o.De(e);if(n){if(t.Ht&&yi(n.target)){var r=new ti(n.target.path);null!==o.Ie.get(r)||o.Ne(e,r)||o.pe(e,r,new Zs(r,i))}t.ae&&(s.set(e,t.ce()),t.le())}});var r=Gi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new Ji(i,s,this.Re,this.Ie,r);return this.Ie=Mi(),this.Ae=ho(),this.Re=new Pi(kr),t},no.prototype.Ve=function(t,e){if(this.be(t)){var n=this.Ne(t,e.key)?2:0;this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t))}},no.prototype.pe=function(t,e,n){if(this.be(t)){var r=this.ve(t);this.Ne(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n))}},no.prototype.removeTarget=function(t){this.me.delete(t)},no.prototype.Fe=function(t){var e=this.ve(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Jt.size},no.prototype.de=function(t){this.ve(t).de()},no.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new to,this.me.set(t,e)),e},no.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new Pi(kr),this.Ae=this.Ae.nt(t,e)),e},no.prototype.be=function(t){var e=null!==this.De(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.Oe(t)},no.prototype.Se=function(e){var n=this;this.me.set(e,new to),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},no.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},no);function no(t){this.Ee=t,this.me=new Map,this.Ie=Mi(),this.Ae=ho(),this.Re=new Pi(kr)}function ro(){this.ne=0,this.se=co(),this.ie=vi.Y,this.re=!1,this.oe=!0}function io(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=r,this.Jt=i}function oo(t,e,n,r,i){this.J=t,this.Wt=e,this.Qt=n,this.jt=r,this.Gt=i}function so(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Mt=i,this.fromCache=o,this.qt=s,this.Ut=a}function ao(){this.xt=new Ni(ti.P)}function uo(n){this.P=n?function(t,e){return n(t,e)||ti.P(t.key,e.key)}:function(t,e){return ti.P(t.key,e.key)},this.$t=ji(),this.Nt=new Ni(this.P)}function ho(){return new Ni(ti.P)}function co(){return new Ni(ti.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new $r(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Dr()}function vo(i,t){var e,n,r,o=yo(i);if(o!==yo(t))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return fo(i).isEqual(fo(t));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Eo(i.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return i.stringValue===t.stringValue;case 6:return r=t,To(i.bytesValue).isEqual(To(r.bytesValue));case 7:return i.referenceValue===t.referenceValue;case 8:return n=t,Io((e=i).geoPointValue.latitude)===Io(n.geoPointValue.latitude)&&Io(e.geoPointValue.longitude)===Io(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),r=Io(e.doubleValue);return n===r?ci(n)===ci(r):isNaN(n)&&isNaN(r)}return!1}(i,t);case 9:return Cr(i.arrayValue.values||[],t.arrayValue.values||[],vo);case 10:return function(t){var e=i.mapValue.fields||{},n=t.mapValue.fields||{};if(Fr(e)!==Fr(n))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(void 0===n[r]||!vo(e[r],n[r])))return!1;return!0}(t);default:return Dr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s,a,u,h,c,l,f=yo(t),p=yo(e);if(f!==p)return kr(f,p);switch(f){case 0:return 0;case 1:return kr(t.booleanValue,e.booleanValue);case 2:return h=e,c=Io(t.integerValue||t.doubleValue),l=Io(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(fo(t),fo(e));case 5:return kr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=To(o),u=To(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=kr(n[i],r[i]);if(0!==o)return o}return kr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=kr(Io(n.latitude),Io(r.latitude)))?i:kr(Io(n.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return kr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=kr(r[s],o[s]);if(0!==a)return a;var u=mo(n[r[s]],i[o[s]]);if(0!==u)return u}return kr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return kr(t,e);var n=Eo(t),r=Eo(e),i=kr(n.seconds,r.seconds);return 0!==i?i:kr(n.nanos,r.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Eo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?To(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ti.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Dr();var t,e,n}(t)}function Eo(t){if(Rr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e=0,n=po.exec(t);if(Rr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function No(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function Do(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var Lo={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Le=e};function Vo(t){return{integerValue:""+t}}function ko(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function Co(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Vo(e):ko(t,e);var n}function Uo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function xo(t){return Rr(!!t),Xr.m((e=Eo(t),new $r(e.seconds,e.nanos)));var e}function Fo(t,e){return new Kr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function jo(t,e){return Fo(t.s,e.path)}function qo(t,e){var n,r,i,o=(r=e,Rr($o(i=Kr.N(r))),i);return Rr(o.get(1)===t.s.projectId),Rr(!o.get(3)&&!t.s.database||o.get(3)===t.s.database),new ti((Rr(4<(n=o).length&&"documents"===n.get(4)),n.p(5)))}function Bo(t,e){return Fo(t.s,e)}function Go(t){return new Kr(["projects",t.s.projectId,"databases",t.s.database]).$()}function Wo(t,e,n){return{name:jo(t,e),fields:n.proto.mapValue.fields}}function Ho(t,e){var n,r,i,o,s,a,u;if(e instanceof Ss)n={update:Wo(t,e.key,e.value)};else if(e instanceof Fs)n={delete:jo(t,e.key)};else if(e instanceof Ds)n={update:Wo(t,e.key,e.data),updateMask:(r=e.Me,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof Vs)n={transform:{document:jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t){var e=t.transform;if(e instanceof Zo)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof ts)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof os)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof hs)return{fieldPath:t.field.$(),increment:e.qe};throw Dr()}(t)})}};else{if(!(e instanceof js))return Dr();n={verify:jo(t,e.key)}}return e.Be.Ue||(n.currentDocument=(o=t,void 0!==(s=e.Be).updateTime?{updateTime:(a=o,u=s.updateTime,Uo(a,u.A()))}:void 0!==s.exists?{exists:s.exists}:Dr())),n}function zo(t){return{before:t.before,values:t.position}}function Yo(t){return{fieldPath:t.$()}}function $o(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Xo(){this.We=void 0}function Qo(t,e){return t instanceof hs?No(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Ko,Jo,Zo=(n(ns,Jo=Xo),ns),ts=(n(es,Ko=Xo),es);function es(t){var e=this;return(e=Ko.call(this)||this).elements=t,e}function ns(){return null!==Jo&&Jo.apply(this,arguments)||this}function rs(t,e){for(var n=fs(e),r=function(e){n.some(function(t){return vo(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var is,os=(n(ss,is=Xo),ss);function ss(t){var e=this;return(e=is.call(this)||this).elements=t,e}function as(t,e){for(var n=fs(e),r=function(e){n=n.filter(function(t){return!vo(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var us,hs=(n(cs,us=Xo),cs);function cs(t,e){var n=this;return(n=us.call(this)||this).serializer=t,n.qe=e,n}function ls(t){return Io(t.integerValue||t.doubleValue)}function fs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ps(t,e){this.field=t,this.transform=e}var ds=(ys.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ys.prototype.isEqual=function(t){return Cr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ys);function ys(t){(this.fields=t).sort(Zr.P)}function vs(t,e){this.version=t,this.transformResults=e}var gs=(ms.je=function(){return new ms},ms.exists=function(t){return new ms(void 0,t)},ms.updateTime=function(t){return new ms(t)},Object.defineProperty(ms.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ms.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ms);function ms(t,e){this.updateTime=t,this.exists=e}function ws(t,e){return void 0!==t.updateTime?e instanceof Js&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Js}function bs(){}function Es(t,e,n){return t instanceof Ss?(i=n,new Js(t.key,i.version,t.value,{hasCommittedMutations:!0})):t instanceof Ds?function(t,e,n){if(!ws(t.Be,e))return new ta(t.key,n.version);var r=Os(t,e);return new Js(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Vs?function(t,e,n){if(Rr(null!=n.transformResults),!ws(t.Be,e))return new ta(t.key,n.version);var r=Cs(0,e),i=function(t,e,n){var r,i,o,s=[];Rr(t.length===n.length);for(var a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Js&&(c=e.field(u.field)),s.push((r=h,i=c,o=n[a],r instanceof ts?rs(r,i):r instanceof os?as(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Us(t,r.data(),i);return new Js(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):(r=n,new Zs(t.key,r.version,{hasCommittedMutations:!0}));var r,i}function Is(t,e,n,r){return t instanceof Ss?function(t,e){if(!ws(t.Be,e))return e;var n=As(e);return new Js(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Ds?function(t,e){if(!ws(t.Be,e))return e;var n=As(e),r=Os(t,e);return new Js(t.key,n,r,{Ge:!0})}(t,e):t instanceof Vs?function(t,e,n,r){if(!ws(t.Be,e))return e;var i=Cs(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,h=null;n instanceof Js&&(h=n.field(a.field)),null===h&&r instanceof Js&&(h=r.field(a.field)),i.push((l=h,f=e,v=y=d=p=void 0,(c=u)instanceof Zo?(v={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:f.seconds,nanos:f.nanoseconds}}}},l&&(v.fields.__previous_value__=l),{mapValue:v}):c instanceof ts?rs(c,l):c instanceof os?as(c,l):(d=Qo(p=c,l),y=ls(d)+ls(p.qe),No(d)&&No(p.qe)?Vo(y):ko(p.serializer,y))))}var c,l,f,p,d,y,v;return i}(t.fieldTransforms,n,e,r),s=Us(t,i.data(),o);return new Js(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,ws((i=t).Be,o)?new Zs(i.key,Xr.min()):o);var i,o}function Ts(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Me.isEqual(e.Me):2!==t.type||Cr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof ts&&o instanceof ts||i instanceof os&&o instanceof os?Cr(i.elements,o.elements,vo):i instanceof hs&&o instanceof hs?vo(i.qe,o.qe):i instanceof Zo&&o instanceof Zo);var n,r,i,o}))}function As(t){return t instanceof Js?t.version:Xr.min()}var Ns,_s,Ss=(n(Ls,_s=bs),Ls),Ds=(n(Rs,Ns=bs),Rs);function Rs(t,e,n,r){var i=this;return(i=Ns.call(this)||this).key=t,i.data=e,i.Me=n,i.Be=r,i.type=1,i}function Ls(t,e,n){var r=this;return(r=_s.call(this)||this).key=t,r.value=e,r.Be=n,r.type=0,r}function Os(t,e){return n=t,r=e instanceof Js?e.data():qs.empty(),i=new Bs(r),n.Me.fields.forEach(function(t){if(!t._()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.Ke();var n,r,i}var Ps,Vs=(n(ks,Ps=bs),ks);function ks(t,e){var n=this;return(n=Ps.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=gs.exists(!0),n}function Cs(t,e){return e}function Us(t,e,n){for(var r=new Bs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ke()}var Ms,xs,Fs=(n(zs,xs=bs),zs),js=(n(Hs,Ms=bs),Hs),qs=(Ws.empty=function(){return new Ws({mapValue:{}})},Ws.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Ws.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Ws),Bs=(Gs.prototype.set=function(t,e){return this.Ye(t,e),this},Gs.prototype.delete=function(t){return this.Ye(t,null),this},Gs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},Gs.prototype.Ke=function(){var t=this.Xe(Zr.k(),this.He);return null!=t?new qs(t):this.ze},Gs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=i.Xe(r.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Gs);function Gs(t){void 0===t&&(t=qs.empty()),this.ze=t,this.He=new Map}function Ws(t){this.proto=t}function Hs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.Be=e,n.type=4,n}function zs(t,e){var n=this;return(n=xs.call(this)||this).key=t,n.Be=e,n.type=3,n}function Ys(t){var a=[];return jr(t.fields||{},function(t,e){var n=new Zr([t]);if(Ro(e)){var r=Ys(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new ds(a)}function $s(t,e){this.key=t,this.version=e}var Xs,Qs,Ks,Js=(n(ra,Ks=$s),ra.prototype.field=function(t){return this.Je.field(t)},ra.prototype.data=function(){return this.Je},ra.prototype.Ze=function(){return this.Je.proto},ra.prototype.isEqual=function(t){return t instanceof ra&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},ra.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ra.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ra),Zs=(n(na,Qs=$s),na.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(na.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),na.prototype.isEqual=function(t){return t instanceof na&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},na),ta=(n(ea,Xs=$s),ea.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ea.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ea.prototype.isEqual=function(t){return t instanceof ea&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ea);function ea(){return null!==Xs&&Xs.apply(this,arguments)||this}function na(t,e,n){var r=this;return(r=Qs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ra(t,e,n,r){var i=this;return(i=Ks.call(this,t,e)||this).Je=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function ia(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yr(zr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yr(zr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var oa=(sa.prototype.rn=function(t){return new sa(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},sa.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.L())},sa.prototype.hn=function(){return!hi(this.limit)&&"F"===this.en},sa.prototype.an=function(){return!hi(this.limit)&&"L"===this.en},sa.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},sa.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},sa.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},sa);function sa(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function aa(t){return new oa(t)}function ua(t){return null!==t.collectionGroup}function ha(t){var e=ia(t,oa);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.L()||e.nn.push(new qa(n)),e.nn.push(new qa(Zr.M(),"asc"));else{for(var i=!1,o=0,s=e.tn;o<s.length;o++){var a=s[o];e.nn.push(a),a.field.L()&&(i=!0)}if(!i){var u=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc";e.nn.push(new qa(Zr.M(),u))}}}return e.nn}function ca(t){var e=ia(t,oa);if(!e.sn)if("F"===e.en)e.sn=fi(e.path,e.collectionGroup,ha(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ha(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new qa(o.field,s))}var a=e.endAt?new Pa(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Pa(e.startAt.position,!e.startAt.before):null;e.sn=fi(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function la(t,e,n){return new oa(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fa(t,e){return new oa(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function pa(t,e){return new oa(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function da(t,e){return di(ca(t),ca(e))&&t.en===e.en}function ya(t){return pi(ca(t))+"|lt:"+t.en}function va(t){return"Query(target="+(e=ca(t),n=e.path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),hi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+xa(e.startAt)),e.endAt&&(n+=", endAt: "+xa(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function ga(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.B(r.collectionGroup)&&r.path.C(o):ti.W(r.path)?r.path.isEqual(o):r.path.D(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Fa(e.startAt,ha(e),n))&&(!e.endAt||!Fa(e.endAt,ha(e),n)));var e,n,r,o}function ma(a){return function(t,e){for(var n=!1,r=0,i=ha(a);r<i.length;r++){var o=i[r],s=Ba(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var wa,ba=(n(Ea,wa=function(){}),Ea.create=function(t,e,n){if(t.L())return"in"===e?new Da(t,n):new Sa(t,e,n);if(So(n)){if("=="!==e)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Ea(t,e,n)}if(Do(n)){if("=="!==e)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Ea(t,e,n)}return"array-contains"===e?new Ra(t,n):"in"===e?new La(t,n):"array-contains-any"===e?new Oa(t,n):new Ea(t,e,n)},Ea.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value)===yo(e)&&this.fn(mo(e,this.value))},Ea.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Dr()}},Ea.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Ea);function Ea(t,e,n){var r=this;return(r=wa.call(this)||this).field=t,r.op=e,r.value=n,r}var Ia,Ta,Aa,Na,_a,Sa=(n(Ma,_a=ba),Ma.prototype.matches=function(t){var e=ti.P(t.key,this.key);return this.fn(e)},Ma),Da=(n(Ua,Na=ba),Ua.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ua),Ra=(n(Ca,Aa=ba),Ca.prototype.matches=function(t){var e=t.field(this.field);return _o(e)&&go(e.arrayValue,this.value)},Ca),La=(n(ka,Ta=ba),ka.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},ka),Oa=(n(Va,Ia=ba),Va.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Va),Pa=function(t,e){this.position=t,this.before=e};function Va(t,e){return Ia.call(this,t,"array-contains-any",e)||this}function ka(t,e){return Ta.call(this,t,"in",e)||this}function Ca(t,e){return Aa.call(this,t,"array-contains",e)||this}function Ua(t,e){var n=this;return(n=Na.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ti.U(t.referenceValue)}),n}function Ma(t,e,n){var r=this;return(r=_a.call(this,t,e,n)||this).key=ti.U(n.referenceValue),r}function xa(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return bo(t)}).join(",")}function Fa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.L()?ti.P(ti.U(s.referenceValue),n.key):mo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ja(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var qa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ba(t,e,n){var r,i,o,s,a=t.field.L()?ti.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?mo(o,s):Dr());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return Dr()}}var Ga=(tu.prototype.wn=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Es(o,e,r[i]))}return e},tu.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Is(i,e,e,this.dn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Is(u,e,o,this.dn))}return e},tu.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},tu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gi())},tu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,function(t,e){return Ts(t,e)})&&Cr(this.baseMutations,t.baseMutations,function(t,e){return Ts(t,e)})},tu),Wa=(Za.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=qi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Za(t,e,n,r)},Za),Ha=(Ja.prototype.catch=function(t){return this.next(void 0,t)},Ja.prototype.next=function(r,i){var o=this;return this.pn&&Dr(),this.pn=!0,this.Vn?this.error?this.yn(i,this.error):this.gn(r,this.result):new Ja(function(e,n){o.Rn=function(t){o.gn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},Ja.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ja.prototype.bn=function(t){try{var e=t();return e instanceof Ja?e:Ja.resolve(e)}catch(t){return Ja.reject(t)}},Ja.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):Ja.resolve(e)},Ja.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):Ja.reject(e)},Ja.resolve=function(n){return new Ja(function(t,e){t(n)})},Ja.reject=function(n){return new Ja(function(t,e){e(n)})},Ja.Sn=function(t){return new Ja(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ja.Cn=function(t){for(var n=Ja.resolve(!1),e=function(e){n=n.next(function(t){return t?Ja.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},Ja.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},Ja),za=(Ka.prototype.Nn=function(e,n){var r=this;return this.Fn.kn(e,n).next(function(t){return r.xn(e,n,t)})},Ka.prototype.xn=function(t,r,i){return this.Dn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},Ka.prototype.Ln=function(t,e,i){var o=xi();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},Ka.prototype.Mn=function(e,t){var n=this;return this.Dn.getEntries(e,t).next(function(t){return n.qn(e,t)})},Ka.prototype.qn=function(r,i){var o=this;return this.Fn.Un(r,i).next(function(t){var e=o.Ln(r,i,t),n=Mi();return e.forEach(function(t,e){e=e||new Zs(t,Xr.min()),n=n.nt(t,e)}),n})},Ka.prototype.Bn=function(t,e,n){return r=e,ti.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wn(t,e.path):ua(e)?this.Qn(t,e,n):this.jn(t,e,n);var r},Ka.prototype.Wn=function(t,e){return this.Nn(t,new ti(e)).next(function(t){var e=ji();return t instanceof Js&&(e=e.nt(t.key,t)),e})},Ka.prototype.Qn=function(n,r,i){var o=this,s=r.collectionGroup,a=ji();return this.$n.Gn(n,s).next(function(t){return Ha.forEach(t,function(t){var e=r.rn(t.child(s));return o.jn(n,e,i).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Ka.prototype.jn=function(e,n,t){var c,l,r=this;return this.Dn.Bn(e,n,t).next(function(t){return c=t,r.Fn.Kn(e,n)}).next(function(t){return l=t,r.zn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=Is(s,u,u,r.dn);c=h instanceof Js?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){ga(n,e)||(c=c.remove(t))}),c})},Ka.prototype.zn=function(t,e,n){for(var r=Gi(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Ds&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.Dn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Js&&(h=h.nt(t,e))}),h})},Ka),Ya=(Qa.Xn=function(t,e){for(var n=Gi(),r=Gi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Qa(t,e.fromCache,n,r)},Qa),$a=(Xa.prototype.Zn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Xa.prototype.next=function(){var t=++this.previousValue;return this.ts&&this.ts(t),t},Xa);function Xa(t,e){var n=this;this.previousValue=t,e&&(e.Jn=function(t){return n.Zn(t)},this.ts=function(t){return e.es(t)})}function Qa(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hn=n,this.Yn=r}function Ka(t,e,n){this.Dn=t,this.Fn=e,this.$n=n}function Ja(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.Vn=!1,this.pn=!1,t(function(t){e.Vn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.Vn=!0,e.error=t,e.Pn&&e.Pn(t)})}function Za(t,e,n,r){this.batch=t,this.In=e,this.Tn=n,this.An=r}function tu(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}$a.ns=-1;function eu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var nu=(hu.prototype.reset=function(){this.us=0},hu.prototype._s=function(){this.us=this.as},hu.prototype.fs=function(t){var e=this;this.cancel();var n=Math.floor(this.us+this.ds()),r=Math.max(0,Date.now()-this.ls),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.us+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.cs=this.ss.ws(this.rs,i,function(){return e.ls=Date.now(),t()}),this.us*=this.hs,this.us<this.os&&(this.us=this.os),this.us>this.as&&(this.us=this.as)},hu.prototype.Ts=function(){null!==this.cs&&(this.cs.Es(),this.cs=null)},hu.prototype.cancel=function(){null!==this.cs&&(this.cs.cancel(),this.cs=null)},hu.prototype.ds=function(){return(Math.random()-.5)*this.us},hu),ru=(uu.prototype.Is=function(t,e){return this.ms.add(e),Ha.resolve()},uu.prototype.Gn=function(t,e){return Ha.resolve(this.ms.getEntries(e))},uu),iu=(au.prototype.add=function(t){var e=t.S(),n=t.g(),r=this.index[e]||new Pi(Kr.P),i=!r.has(n);return this.index[e]=r.add(n),i},au.prototype.has=function(t){var e=t.S(),n=t.g(),r=this.index[e];return r&&r.has(n)},au.prototype.getEntries=function(t){return(this.index[t]||new Pi(Kr.P)).F()},au),ou=(su.prototype.next=function(){return this.As+=2,this.As},su.Rs=function(){return new su(0)},su.Ps=function(){return new su(-1)},su);function su(t){this.As=t}function au(){this.index={}}function uu(){this.ms=new iu}function hu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ss=t,this.rs=e,this.os=n,this.hs=r,this.as=i,this.us=0,this.cs=null,this.ls=Date.now(),this.reset()}function cu(t){return"IndexedDbTransactionError"===t.name}function lu(){return"undefined"!=typeof window?window:null}var fu=(yu.vs=function(t,e,n,r,i){var o=new yu(t,e,Date.now()+n,r,i);return o.start(n),o},yu.prototype.start=function(t){var e=this;this.bs=setTimeout(function(){return e.Ss()},t)},yu.prototype.Es=function(){return this.Ss()},yu.prototype.cancel=function(t){null!==this.bs&&(this.clearTimeout(),this.gs.reject(new Yr(zr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},yu.prototype.Ss=function(){var e=this;this.Vs.Cs(function(){return null!==e.bs?(e.clearTimeout(),e.op().then(function(t){return e.gs.resolve(t)})):Promise.resolve()})},yu.prototype.clearTimeout=function(){null!==this.bs&&(this.ys(this),clearTimeout(this.bs),this.bs=null)},yu),pu=(Object.defineProperty(du.prototype,"qs",{get:function(){return this.$s},enumerable:!1,configurable:!0}),du.prototype.Cs=function(t){this.enqueue(t)},du.prototype.Us=function(t){this.Bs(),this.Ws(t)},du.prototype.Qs=function(t){return this.Bs(),this.Ws(t)},du.prototype.js=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Bs(),this.$s?[3,2]:(this.$s=!0,(e=lu())&&e.removeEventListener("visibilitychange",this.Ms),[4,this.Qs(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},du.prototype.enqueue=function(t){return this.Bs(),this.$s?new Promise(function(t){}):this.Ws(t)},du.prototype.Gs=function(t){var e=this;this.Fs.push(t),this.Cs(function(){return e.Ks()})},du.prototype.Ks=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Fs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fs[0]()];case 2:return t.sent(),this.Fs.shift(),this.Ls.reset(),[3,4];case 3:if(!cu(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Fs.length&&this.Ls.fs(function(){return n.Ks()}),t.label=5;case 5:return[2]}})})},du.prototype.Ws=function(t){var r=this,e=this.Ds.then(function(){return r.xs=!0,t().catch(function(t){throw r.ks=t,r.xs=!1,_r("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.xs=!1,t})});return this.Ds=e},du.prototype.ws=function(t,e,n){var r=this;this.Bs(),-1<this.Os.indexOf(t)&&(e=0);var i=fu.vs(this,t,e,n,function(t){return r.zs(t)});return this.Ns.push(i),i},du.prototype.Bs=function(){this.ks&&Dr()},du.prototype.Hs=function(){},du.prototype.Ys=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ds)return[3,0];t.label=3;case 3:return[2]}})})},du.prototype.Xs=function(t){for(var e=0,n=this.Ns;e<n.length;e++)if(n[e].rs===t)return!0;return!1},du.prototype.Js=function(r){var i=this;return this.Ys().then(function(){i.Ns.sort(function(t,e){return t.ps-e.ps});for(var t=0,e=i.Ns;t<e.length;t++){var n=e[t];if(n.Es(),"all"!==r&&n.rs===r)break}return i.Ys()})},du.prototype.Zs=function(t){this.Os.push(t)},du.prototype.zs=function(t){var e=this.Ns.indexOf(t);this.Ns.splice(e,1)},du);function du(){var t=this;this.Ds=Promise.resolve(),this.Fs=[],this.$s=!1,this.Ns=[],this.ks=null,this.xs=!1,this.Os=[],this.Ls=new nu(this,"async_queue_retry"),this.Ms=function(){return t.Ls.Ts()};var e=lu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ms)}function yu(t,e,n,r,i){this.Vs=t,this.rs=e,this.ps=n,this.op=r,this.ys=i,this.gs=new eu,this.then=this.gs.promise.then.bind(this.gs.promise),this.gs.promise.catch(function(t){})}function vu(t,e){if(_r("AsyncQueue",e+": "+t),cu(t))return new Yr(zr.UNAVAILABLE,e+": "+t);throw t}var gu=(mu.si=function(t){return new mu(t,mu.ii,mu.ri)},mu);function mu(t,e,n){this.ti=t,this.ei=e,this.ni=n}gu.oi=-1,gu.hi=1048576,gu.ai=41943040,gu.ii=10,gu.ri=1e3,gu.ui=new gu(gu.ai,gu.ii,gu.ri),gu.ci=new gu(gu.oi,0,0);var wu=(bu.prototype.Vi=function(i){return d(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Fn,m=this.Ai,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Fn.pi(v).next(function(t){return g=t,e=r.persistence.wi(i),m=new za(r.Ti,e,r.persistence.Ri()),e.pi(v)}).next(function(t){for(var e=[],n=[],r=Gi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++){var h=u[a];r=r.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Mn(v,r).next(function(t){return{yi:t,gi:e,vi:n}})})})];case 1:return n=t.sent(),[2,(this.Fn=e,this.Ai=m,this.li.Pi(this.Ai),n)]}})})},bu.prototype.bi=function(h){var c,l=this,f=$r.now(),t=h.reduce(function(t,e){return t.add(e.key)},Gi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ai.Mn(u,t).next(function(t){c=t;for(var e=[],n=0,r=h;n<r.length;n++){var i=r[n],o=(a=i,s=c.get(i.key),a instanceof Vs?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Js?t.field(i.field):void 0,s=Qo(i.transform,o||null);null!=s&&(e=null==e?(new Bs).set(i.field,s):e.set(i.field,s))}return e?e.Ke():null}(s):null);null!=o&&e.push(new Ds(i.key,o,Ys(o.proto.mapValue),gs.exists(!0)))}var a,s;return l.Fn.Si(u,f,e,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Ci:e}})},bu.prototype.Di=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ti.Fi({$i:!0});return i.Ni(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Fn.ki(t)}).next(function(){return i.Ai.Mn(t,e)})})},bu.prototype.xi=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Fn.Oi(e,t).next(function(t){return Rr(null!==t),n=t.keys(),r.Fn.Li(e,t)}).next(function(){return r.Fn.ki(e)}).next(function(){return r.Ai.Mn(e,n)})})},bu.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fn.Mi(t)})},bu.prototype.qi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mi.qi(t)})},bu.prototype.Ui=function(u){var h=this,c=u.J,l=this._i;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ti.Fi({$i:!0});l=h._i;var s=[];u.Wt.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.mi.Bi(o,t.Jt,e).next(function(){return h.mi.Wi(o,t.Yt,e)}));var r=t.resumeToken;if(0<r.H()){var i=n.tt(r,c).Z(o.Qi);l=l.nt(e,i),bu.ji(n,i,t)&&s.push(h.mi.Gi(o,i))}}});var a=Mi(),n=Gi();if(u.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){u.jt.forEach(function(t,e){var n=r.get(t);e instanceof Zs&&e.version.isEqual(Xr.min())?(i.Ki(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.zi(e,c),a=a.nt(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Yi.Hi(o,t))})})),!c.isEqual(Xr.min())){var t=h.mi.qi(o).next(function(t){return h.mi.Xi(o,o.Qi,c)});s.push(t)}return Ha.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ai.qn(o,a)})}).then(function(t){return h._i=l,t})},bu.ji=function(t,e,n){return Rr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Ji||0<n.Yt.size+n.Xt.size+n.Jt.size},bu.prototype.Zi=function(c){return d(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ha.forEach(c,function(e){return Ha.forEach(e.Hn,function(t){return h.persistence.Yi.tr(n,e.targetId,t)}).next(function(){return Ha.forEach(e.Yn,function(t){return h.persistence.Yi.er(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!cu(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this._i.get(o),a=s.J,u=s.et(a),this._i=this._i.nt(o,u));return[2]}})})},bu.prototype.nr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fn.sr(t,e)})},bu.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ai.Nn(t,e)})},bu.prototype.rr=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.mi.or(e,r).next(function(t){return t?(n=t,Ha.resolve(n)):i.mi.hr(e).next(function(t){return n=new Ei(r,t,0,e.Qi),i.mi.ar(e,n).next(function(){return n})})})}).then(function(t){var e=i._i.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i._i=i._i.nt(t.targetId,t),i.fi.set(r,t.targetId)),t})},bu.prototype.or=function(t,e){var n=this.fi.get(e);return void 0!==n?Ha.resolve(this._i.get(n)):this.mi.or(t,e)},bu.prototype.ur=function(o,s){return d(this,void 0,void 0,function(){var e,n,r,i=this;return y(this,function(t){switch(t.label){case 0:e=this._i.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.Yi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!cu(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this._i=this._i.remove(o),this.fi.delete(e.target),[2]}})})},bu.prototype.cr=function(t,n){var r=this,i=Xr.min(),o=Gi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.or(e,ca(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.mi.lr(e,t.targetId).next(function(t){o=t})}).next(function(){return r.li.Bn(e,t,n?i:Xr.min(),n?o:Gi())}).next(function(t){return{documents:t,_r:o}})})},bu.prototype.Ni=function(t,i,o){var e=this,s=i.batch,n=s.keys(),a=Ha.resolve();return n.forEach(function(r){a=a.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.An.get(r);Rr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.zi(e,i.In)})}),a.next(function(){return e.Fn.Li(t,s)})},bu.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.wr(t,n._i)})},bu);function bu(t,e,n){this.persistence=t,this.li=e,this._i=new Ni(kr),this.fi=new Hr(function(t){return pi(t)},di),this.di=Xr.min(),this.Fn=t.wi(n),this.Ti=t.Ei(),this.mi=t.Ii(),this.Ai=new za(this.Ti,this.Fn,this.persistence.Ri()),this.li.Pi(this.Ai)}function Eu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==zr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}wu.Ji=3e8;var Iu=(Nu.prototype._=function(){return this.Tr._()},Nu.prototype.tr=function(t,e){var n=new Tu(t,e);this.Tr=this.Tr.add(n),this.mr=this.mr.add(n)},Nu.prototype.Ar=function(t,e){var n=this;t.forEach(function(t){return n.tr(t,e)})},Nu.prototype.er=function(t,e){this.Rr(new Tu(t,e))},Nu.prototype.Pr=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},Nu.prototype.Vr=function(t){var e=this,n=new ti(new Kr([])),r=new Tu(n,t),i=new Tu(n,t+1),o=[];return this.mr.bt([r,i],function(t){e.Rr(t),o.push(t.key)}),o},Nu.prototype.pr=function(){var e=this;this.Tr.forEach(function(t){return e.Rr(t)})},Nu.prototype.Rr=function(t){this.Tr=this.Tr.delete(t),this.mr=this.mr.delete(t)},Nu.prototype.yr=function(t){var e=new ti(new Kr([])),n=new Tu(e,t),r=new Tu(e,t+1),i=Gi();return this.mr.bt([n,r],function(t){i=i.add(t.key)}),i},Nu.prototype.gr=function(t){var e=new Tu(t,0),n=this.Tr.Ct(e);return null!==n&&t.isEqual(n.key)},Nu),Tu=(Au.Er=function(t,e){return ti.P(t.key,e.key)||kr(t.vr,e.vr)},Au.Ir=function(t,e){return kr(t.vr,e.vr)||ti.P(t.key,e.key)},Au);function Au(t,e){this.key=t,this.vr=e}function Nu(){this.Tr=new Pi(Tu.Er),this.mr=new Pi(Tu.Ir)}function _u(t,e){if(0!==e.length)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Wu(e.length,"argument")+".")}function Su(t,e,n){if(e.length!==n)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires "+Wu(n,"argument")+", but was called with "+Wu(e.length,"argument")+".")}function Du(t,e,n){if(e.length<n)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Wu(n,"argument")+", but was called with "+Wu(e.length,"argument")+".")}function Ru(t,e,n,r){if(e.length<n||e.length>r)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Wu(e.length,"argument")+".")}function Lu(t,e,n,r){Uu(t,e,Gu(n)+" argument",r)}function Ou(t,e,n,r){void 0!==r&&Lu(t,e,n,r)}function Pu(t,e,n,r){Uu(t,e,n+" option",r)}function Vu(t,e,n,r){void 0!==r&&Pu(t,e,n,r)}function ku(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(xu(s))}var a=xu(n);throw new Yr(zr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Cu(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Yr(zr.INVALID_ARGUMENT,"Invalid value "+xu(r)+" provided to function "+t+"() for its "+Gu(n)+" argument. Acceptable values: "+e.join(", "));return r}function Uu(t,e,n,r){if(!("object"===e?Mu(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=xu(r);throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Mu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function xu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Dr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Fu(t,e,n){if(void 0===n)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Gu(e)+" argument, but it was undefined.")}function ju(n,t,r){jr(t,function(t,e){if(r.indexOf(t)<0)throw new Yr(zr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function qu(t,e,n,r){var i=xu(r);return new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gu(n)+" argument to be a "+e+", but it was: "+i)}function Bu(t,e,n){if(n<=0)throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gu(e)+" argument to be a positive number, but it was: "+n+".")}function Gu(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Wu(t,e){return t+" "+e+(1===t?"":"s")}function Hu(){if("undefined"==typeof Uint8Array)throw new Yr(zr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function zu(){if("undefined"==typeof atob)throw new Yr(zr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Yu,$u,Xu=(rh.fromBase64String=function(t){Su("Blob.fromBase64String",arguments,1),Lu("Blob.fromBase64String","string",1,t),zu();try{return new rh(vi.fromBase64String(t))}catch(t){throw new Yr(zr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},rh.fromUint8Array=function(t){if(Su("Blob.fromUint8Array",arguments,1),Hu(),!(t instanceof Uint8Array))throw qu("Blob.fromUint8Array","Uint8Array",1,t);return new rh(vi.fromUint8Array(t))},rh.prototype.toBase64=function(){return Su("Blob.toBase64",arguments,0),zu(),this.br.toBase64()},rh.prototype.toUint8Array=function(){return Su("Blob.toUint8Array",arguments,0),Hu(),this.br.toUint8Array()},rh.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},rh.prototype.isEqual=function(t){return this.br.isEqual(t.br)},rh),Qu=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yr(zr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Lu("FieldPath","string",e,t[e]),0===t[e].length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Sr=new Zr(t)},Ku=(n(nh,$u=Qu),nh.documentId=function(){return new nh(Zr.M().$())},nh.prototype.isEqual=function(t){if(!(t instanceof nh))throw qu("isEqual","FieldPath",1,t);return this.Sr.isEqual(t.Sr)},nh),Ju=new RegExp("[~\\*/\\[\\]]"),Zu=function(){this.Cr=this},th=(n(eh,Yu=Zu),eh.prototype.Fr=function(t){if(2!==t.$r)throw 1===t.$r?t.Nr(this.Dr+"() can only appear at the top level of your update data"):t.Nr(this.Dr+"() cannot be used with set() unless you pass {merge:true}");return t.Me.push(t.path),null},eh.prototype.isEqual=function(t){return t instanceof eh},eh);function eh(t){var e=this;return(e=Yu.call(this)||this).Dr=t,e}function nh(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return $u.call(this,t)||this}function rh(t){zu(),this.br=t}function ih(t,e,n){return new Vh({$r:3,kr:e.settings.kr,methodName:t.Dr,xr:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var oh,sh,ah,uh,hh,ch,lh=(n(Ah,ch=Zu),Ah.prototype.Fr=function(t){return new ps(t.path,new Zo)},Ah.prototype.isEqual=function(t){return t instanceof Ah},Ah),fh=(n(Th,hh=Zu),Th.prototype.Fr=function(t){var e=ih(this,t,!0),n=this.Or.map(function(t){return qh(t,e)}),r=new ts(n);return new ps(t.path,r)},Th.prototype.isEqual=function(t){return this===t},Th),ph=(n(Ih,uh=Zu),Ih.prototype.Fr=function(t){var e=ih(this,t,!0),n=this.Or.map(function(t){return qh(t,e)}),r=new os(n);return new ps(t.path,r)},Ih.prototype.isEqual=function(t){return this===t},Ih),dh=(n(Eh,ah=Zu),Eh.prototype.Fr=function(t){var e=new hs(t.serializer,Co(t.serializer,this.Lr));return new ps(t.path,e)},Eh.prototype.isEqual=function(t){return this===t},Eh),yh=(n(bh,sh=Zu),bh.delete=function(){return _u("FieldValue.delete",arguments),new vh(new th("FieldValue.delete"))},bh.serverTimestamp=function(){return _u("FieldValue.serverTimestamp",arguments),new vh(new lh("FieldValue.serverTimestamp"))},bh.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Du("FieldValue.arrayUnion",arguments,1),new vh(new fh("FieldValue.arrayUnion",t))},bh.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Du("FieldValue.arrayRemove",arguments,1),new vh(new ph("FieldValue.arrayRemove",t))},bh.increment=function(t){return Lu("FieldValue.increment","number",1,t),Su("FieldValue.increment",arguments,1),new vh(new dh("FieldValue.increment",t))},bh),vh=(n(wh,oh=yh),wh.prototype.Fr=function(t){return this.Cr.Fr(t)},wh.prototype.isEqual=function(t){return t instanceof wh&&this.Cr.isEqual(t.Cr)},wh),gh=(Object.defineProperty(mh.prototype,"latitude",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),Object.defineProperty(mh.prototype,"longitude",{get:function(){return this.qr},enumerable:!1,configurable:!0}),mh.prototype.isEqual=function(t){return this.Mr===t.Mr&&this.qr===t.qr},mh.prototype.T=function(t){return kr(this.Mr,t.Mr)||kr(this.qr,t.qr)},mh);function mh(t,e){if(Su("GeoPoint",arguments,2),Lu("GeoPoint","number",1,t),Lu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yr(zr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yr(zr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Mr=t,this.qr=e}function wh(t){var e=this;return(e=oh.call(this)||this).Cr=t,e.Dr=t.Dr,e}function bh(){return sh.call(this)||this}function Eh(t,e){var n=this;return(n=ah.call(this)||this).Dr=t,n.Lr=e,n}function Ih(t,e){var n=this;return(n=uh.call(this)||this).Dr=t,n.Or=e,n}function Th(t,e){var n=this;return(n=hh.call(this)||this).Dr=t,n.Or=e,n}function Ah(t){var e=this;return(e=ch.call(this)||this).Dr=t,e}function Nh(t){return new Po(t,!0)}var _h=/^__.*__$/,Sh=function(t,e,n){this.Ur=t,this.Br=e,this.Wr=n},Dh=(Oh.prototype.Qr=function(t,e){var n=[];return null!==this.Me?n.push(new Ds(t,this.data,this.Me,e)):n.push(new Ss(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Vs(t,this.fieldTransforms)),n},Oh),Rh=(Lh.prototype.Qr=function(t,e){var n=[new Ds(t,this.data,this.Me,e)];return 0<this.fieldTransforms.length&&n.push(new Vs(t,this.fieldTransforms)),n},Lh);function Lh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Oh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Ph(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Dr()}}var Vh=(Object.defineProperty(Uh.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Uh.prototype,"$r",{get:function(){return this.settings.$r},enumerable:!1,configurable:!0}),Uh.prototype.Gr=function(t){return new Uh(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Me)},Uh.prototype.Kr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.zr(t),r},Uh.prototype.Hr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.jr(),r},Uh.prototype.Yr=function(t){return this.Gr({path:void 0,xr:!0})},Uh.prototype.Nr=function(t){return Yh(t,this.settings.methodName,this.settings.Xr||!1,this.path,this.settings.kr)},Uh.prototype.contains=function(e){return void 0!==this.Me.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},Uh.prototype.jr=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.zr(this.path.get(t))},Uh.prototype.zr=function(t){if(0===t.length)throw this.Nr("Document fields must not be empty");if(Ph(this.$r)&&_h.test(t))throw this.Nr('Document fields cannot begin and end with "__"')},Uh),kh=(Ch.prototype.Jr=function(t,e,n,r){return void 0===r&&(r=!1),new Vh({$r:t,methodName:e,kr:n,path:Zr.k(),xr:!1,Xr:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Ch);function Ch(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Nh(t)}function Uh(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.jr(),this.fieldTransforms=i||[],this.Me=o||[]}function Mh(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Jr(o.merge||o.mergeFields?2:0,e,n,i);Wh("Data must be an object, but it was:",s,r);var a,u,h=Bh(r,s);if(o.merge)a=new ds(s.Me),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Qu)d=p.Sr;else{if("string"!=typeof p)throw Dr();d=zh(e,p,n)}if(!s.contains(d))throw new Yr(zr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");$h(c,d)||c.push(d)}a=new ds(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new Dh(new qs(h),a,u)}function xh(t,o,s,e){var a=t.Jr(1,o,s);Wh("Data must be an object, but it was:",a,e);var u=[],h=new Bs;jr(e,function(t,e){var n=zh(o,t,s),r=a.Hr(n);if(e instanceof Zu&&e.Cr instanceof th)u.push(n);else{var i=qh(e,r);null!=i&&(u.push(n),h.set(n,i))}});var n=new ds(u);return new Rh(h.Ke(),n,a.fieldTransforms)}function Fh(t,e,n,r,i,o){var s=t.Jr(1,e,n),a=[Hh(e,r,n)],u=[i];if(o.length%2!=0)throw new Yr(zr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(Hh(e,o[h])),u.push(o[h+1]);for(var c=[],l=new Bs,f=a.length-1;0<=f;--f)if(!$h(c,a[f])){var p=a[f],d=u[f],y=s.Hr(p);if(d instanceof Zu&&d.Cr instanceof th)c.push(p);else{var v=qh(d,y);null!=v&&(c.push(p),l.set(p,v))}}var g=new ds(c);return new Rh(l.Ke(),g,s.fieldTransforms)}function jh(t,e,n,r){return void 0===r&&(r=!1),qh(n,t.Jr(r?4:3,e))}function qh(s,t){if(Gh(s))return Wh("Unsupported field value:",t,s),Bh(s,t);if(s instanceof Zu)return function(t,e){if(!Ph(e.$r))throw e.Nr(t.Dr+"() can only be used with update() and set()");if(!e.path)throw e.Nr(t.Dr+"() is not currently supported inside arrays");var n=t.Fr(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Me.push(t.path),s instanceof Array){if(t.settings.xr&&4!==t.$r)throw t.Nr("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=qh(i[r],t.Yr(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,r)}}if(t instanceof gh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xu)return{bytesValue:Mo(e.serializer,t)};if(t instanceof Sh){var i=e.s,o=t.Ur;if(!o.isEqual(i))throw e.Nr("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Fo(t.Ur||e.s,t.Br.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Nr("Unsupported field value: "+xu(t))}(s,t)}function Bh(t,r){var i={};return qr(t)?r.path&&0<r.path.length&&r.Me.push(r.path):jr(t,function(t,e){var n=qh(e,r.Kr(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Gh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof gh||t instanceof Xu||t instanceof Sh||t instanceof Zu)}function Wh(t,e,n){if(!Gh(n)||!Mu(n)){var r=xu(n);throw"an object"===r?e.Nr(t+" a custom object"):e.Nr(t+" "+r)}}function Hh(t,e,n){if(e instanceof Qu)return e.Sr;if("string"==typeof e)return zh(t,e);throw Yh("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function zh(t,e,n){try{return function(e){if(0<=e.search(Ju))throw new Yr(zr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ku.bind.apply(Ku,v([void 0],e.split("."))))}catch(t){throw new Yr(zr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Sr}catch(e){throw Yh(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Yh(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Yr(zr.INVALID_ARGUMENT,(a+=". ")+t+u)}function $h(t,e){return t.some(function(t){return t.isEqual(e)})}var Xh=(Qh.prototype.Zr=function(){return null!=this.uid},Qh.prototype.to=function(){return this.Zr()?"uid:"+this.uid:"anonymous-user"},Qh.prototype.isEqual=function(t){return t.uid===this.uid},Qh);function Qh(t){this.uid=t}Xh.UNAUTHENTICATED=new Xh(null),Xh.eo=new Xh("google-credentials-uid"),Xh.no=new Xh("first-party-uid");function Kh(t,e){this.user=e,this.type="OAuth",this.so={},this.so.Authorization="Bearer "+t}function Jh(t){this.key=t}function Zh(t){this.key=t}function tc(t,e,n){this.query=t,this.targetId=e,this.view=n}function ec(t){this.key=t,this.Qa=!1}function nc(){this.Vu=void 0,this.listeners=[]}var rc,ic,oc,sc,ac=($c.prototype.getToken=function(){return Promise.resolve(null)},$c.prototype.ro=function(){},$c.prototype.oo=function(t){(this.io=t)(Xh.UNAUTHENTICATED)},$c.prototype.ho=function(){this.io=null},$c),uc=(Yc.prototype.getToken=function(){var e=this,n=this.co,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.co!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new Kh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Yc.prototype.ro=function(){this.forceRefresh=!0},Yc.prototype.oo=function(t){this.io=t,this.uo&&t(this.currentUser)},Yc.prototype.ho=function(){this.auth&&this.auth.removeAuthTokenListener(this.ao),this.ao=null,this.io=null},Yc.prototype.lo=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new Xh(t)},Yc),hc=(Object.defineProperty(zc.prototype,"so",{get:function(){var t={"X-Goog-AuthUser":this.fo},e=this._o.auth.do([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),zc),cc=(Hc.prototype.getToken=function(){return Promise.resolve(new hc(this._o,this.fo))},Hc.prototype.oo=function(t){t(Xh.no)},Hc.prototype.ho=function(){},Hc.prototype.ro=function(){},Hc),lc=(Wc.prototype.Ao=function(){return 1===this.state||2===this.state||4===this.state},Wc.prototype.Ro=function(){return 2===this.state},Wc.prototype.start=function(){3!==this.state?this.auth():this.Po()},Wc.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ao()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wc.prototype.Vo=function(){this.state=0,this.Ls.reset()},Wc.prototype.po=function(){var t=this;this.Ro()&&null===this.Io&&(this.Io=this.ss.ws(this.wo,6e4,function(){return t.yo()}))},Wc.prototype.vo=function(t){this.bo(),this.stream.send(t)},Wc.prototype.yo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ro()?[2,this.close(0)]:[2]})})},Wc.prototype.bo=function(){this.Io&&(this.Io.cancel(),this.Io=null)},Wc.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.bo(),this.Ls.cancel(),this.mo++,3!==e?this.Ls.reset():n&&n.code===zr.RESOURCE_EXHAUSTED?(_r(n.toString()),_r("Using maximum backoff delay to prevent overloading the backend."),this.Ls._s()):n&&n.code===zr.UNAUTHENTICATED&&this.Eo.ro(),null!==this.stream&&(this.So(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Co(n)];case 1:return t.sent(),[2]}})})},Wc.prototype.So=function(){},Wc.prototype.auth=function(){var n=this;this.state=1;var t=this.Do(this.mo),e=this.mo;this.Eo.getToken().then(function(t){n.mo===e&&n.Fo(t)},function(e){t(function(){var t=new Yr(zr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.$o(t)})})},Wc.prototype.Fo=function(t){var e=this,n=this.Do(this.mo);this.stream=this.No(t),this.stream.ko(function(){n(function(){return e.state=2,e.listener.ko()})}),this.stream.Co(function(t){n(function(){return e.$o(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Wc.prototype.Po=function(){var t=this;this.state=4,this.Ls.fs(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Wc.prototype.$o=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Wc.prototype.Do=function(e){var n=this;return function(t){n.ss.Cs(function(){return n.mo===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Wc),fc=(n(Gc,oc=lc),Gc.prototype.No=function(t){return this.To.xo("Listen",t)},Gc.prototype.onMessage=function(t){this.Ls.reset();var e=function(t,e){var n,r,i,o,s,a;if("targetChange"in e){e.targetChange;var u="NO_CHANGE"===(a=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===a?1:"REMOVE"===a?2:"CURRENT"===a?3:"RESET"===a?4:Dr(),h=e.targetChange.targetIds||[],c=(o=t,s=e.targetChange.resumeToken,o.Le?(Rr(void 0===s||"string"==typeof s),vi.fromBase64String(s||"")):(Rr(void 0===s||s instanceof Uint8Array),vi.fromUint8Array(s||new Uint8Array))),l=e.targetChange.cause,f=l&&(i=void 0===(r=l).code?zr.UNKNOWN:Ai(r.code),new Yr(i,r.message||""));n=new $i(u,h,c,f||null)}else if("documentChange"in e){e.documentChange;var p=e.documentChange;p.document,p.document.name,p.document.updateTime;var d=qo(t,p.document.name),y=xo(p.document.updateTime),v=new qs({mapValue:{fields:p.document.fields}}),g=new Js(d,y,v,{}),m=p.targetIds||[],w=p.removedTargetIds||[];n=new zi(m,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;var b=e.documentDelete;b.document;var E=qo(t,b.document),I=b.readTime?xo(b.readTime):Xr.min(),T=new Zs(E,I),A=b.removedTargetIds||[];n=new zi([],A,T.key,T)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var _=qo(t,N.document),S=N.removedTargetIds||[];n=new zi([],S,_,null)}else{if(!("filter"in e))return Dr();e.filter;var D=e.filter;D.targetId;var R=D.count||0,L=new mi(R),O=D.targetId;n=new Yi(O,L)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Xr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Xr.min():xo(e.readTime)}(t);return this.listener.Oo(e,n)},Gc.prototype.Lo=function(t){var e,n,r,i,o={};o.database=Go(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=yi(i)?{documents:{documents:[Bo(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.g()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof ba?function(t){if("=="===t.op){if(Do(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Yo(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e}(t):Dr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Yo((e=t).field),direction:(n=e.dir,Lo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a,u=(s=t,a=e.limit,s.Le||hi(a)?a:{value:a});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=zo(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.vo(o)},Gc.prototype.Mo=function(t){var e={};e.database=Go(this.serializer),e.removeTarget=t,this.vo(e)},Gc),pc=(n(Bc,ic=lc),Object.defineProperty(Bc.prototype,"Uo",{get:function(){return this.qo},enumerable:!1,configurable:!0}),Bc.prototype.start=function(){this.qo=!1,this.lastStreamToken=void 0,ic.prototype.start.call(this)},Bc.prototype.So=function(){this.qo&&this.Bo([])},Bc.prototype.No=function(t){return this.To.xo("Write",t)},Bc.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.qo){this.Ls.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Rr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(Xr.min())&&(n=xo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new vs(n,r)}(t,i)})):[]),n=xo(t.commitTime);return this.listener.Wo(n,e)}var r,i;return Rr(!t.writeResults||0===t.writeResults.length),this.qo=!0,this.listener.Qo()},Bc.prototype.jo=function(){var t={};t.database=Go(this.serializer),this.vo(t)},Bc.prototype.Bo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ho(e.serializer,t)})};this.vo(n)},Bc),dc=(n(qc,rc=function(){}),qc.prototype.Ko=function(){if(this.Go)throw new Yr(zr.FAILED_PRECONDITION,"The client has already been terminated.")},qc.prototype.start=function(t){this.To=t},qc.prototype.zo=function(e,n){var r=this;return this.Ko(),this.credentials.getToken().then(function(t){return r.To.zo(e,n,t)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&r.credentials.ro(),t})},qc.prototype.Ho=function(e,n){var r=this;return this.Ko(),this.credentials.getToken().then(function(t){return r.To.Ho(e,n,t)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&r.credentials.ro(),t})},qc),yc=(jc.prototype.eh=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.nh(),0<this.mutations.length)throw new Yr(zr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return d(this,void 0,void 0,function(){var i,e,n,o,r;return y(this,function(t){switch(t.label){case 0:return i=Lr(s),e={database:Go(i.serializer),documents:a.map(function(t){return jo(i.serializer,t)})},[4,i.Ho("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=qo(t,e.found.name),r=xo(e.found.updateTime),i=new qs({mapValue:{fields:e.found.fields}});return new Js(n,r,i,{})}(e,n):"missing"in n?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);var n=qo(t,e.missing),r=xo(e.readTime);return new Zs(n,r)}(e,n):Dr());o.set(r.key.toString(),r)}),r=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Rr(!!e),r.push(e)}),r)]}})})}(this.Yo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Zs||t instanceof Js?n.sh(t):Dr()}),e)]}})})},jc.prototype.set=function(t,e){this.write(e.Qr(t,this.Be(t))),this.th.add(t)},jc.prototype.update=function(t,e){try{this.write(e.Qr(t,this.ih(t)))}catch(t){this.Zo=t}this.th.add(t)},jc.prototype.delete=function(t){this.write([new Fs(t,this.Be(t))]),this.th.add(t)},jc.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:if(this.nh(),this.Zo)throw this.Zo;return e=this.Xo,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ti(Kr.N(e));r.mutations.push(new js(n,r.Be(n)))}),[4,function(r,i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=Lr(r),n={database:Go(e.serializer),writes:i.map(function(t){return Ho(e.serializer,t)})},[4,e.zo("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Yo,this.mutations)];case 1:return t.sent(),this.Jo=!0,[2]}})})},jc.prototype.sh=function(t){var e;if(t instanceof Js)e=t.version;else{if(!(t instanceof Zs))throw Dr();e=Xr.min()}var n=this.Xo.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(zr.ABORTED,"Document version changed between two reads.")}else this.Xo.set(t.key.toString(),e)},jc.prototype.Be=function(t){var e=this.Xo.get(t.toString());return!this.th.has(t)&&e?gs.updateTime(e):gs.je()},jc.prototype.ih=function(t){var e=this.Xo.get(t.toString());if(this.th.has(t)||!e)return gs.exists(!0);if(e.isEqual(Xr.min()))throw new Yr(zr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)},jc.prototype.write=function(t){this.nh(),this.mutations=this.mutations.concat(t)},jc.prototype.nh=function(){},jc),vc=(Fc.prototype.uh=function(){var t=this;0===this.oh&&(this.lh("Unknown"),this.hh=this.Vs.ws("online_state_timeout",1e4,function(){return t.hh=null,t._h("Backend didn't respond within 10 seconds."),t.lh("Offline"),Promise.resolve()}))},Fc.prototype.fh=function(t){"Online"===this.state?this.lh("Unknown"):(this.oh++,1<=this.oh&&(this.dh(),this._h("Connection failed 1 times. Most recent error: "+t.toString()),this.lh("Offline")))},Fc.prototype.set=function(t){this.dh(),this.oh=0,"Online"===t&&(this.ah=!1),this.lh(t)},Fc.prototype.lh=function(t){t!==this.state&&(this.state=t,this.rh(t))},Fc.prototype._h=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.ah?(_r(e),this.ah=!1):Nr("OnlineStateTracker",e)},Fc.prototype.dh=function(){null!==this.hh&&(this.hh.cancel(),this.hh=null)},Fc),gc=(xc.prototype.start=function(){return this.enableNetwork()},xc.prototype.enableNetwork=function(){return this.Ih.delete(0),this.$h()},xc.prototype.$h=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ph()?(this.Nh()?this.kh():this.ph.set("Unknown"),[4,this.xh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},xc.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ih.add(0),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Offline"),[2]}})})},xc.prototype.Oh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Sh.stop()];case 1:return t.sent(),[4,this.yh.stop()];case 2:return t.sent(),0<this.Th.length&&(Nr("RemoteStore","Stopping write stream with "+this.Th.length+" pending writes"),this.Th=[]),this.Lh(),[2]}})})},xc.prototype.Mh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","RemoteStore shutting down."),this.Ih.add(5),[4,this.Oh()];case 1:return t.sent(),this.Ah.Mh(),this.ph.set("Unknown"),[2]}})})},xc.prototype.listen=function(t){this.Eh.has(t.targetId)||(this.Eh.set(t.targetId,t),this.Nh()?this.kh():this.yh.Ro()&&this.qh(t))},xc.prototype.Uh=function(t){this.Eh.delete(t),this.yh.Ro()&&this.Bh(t),0===this.Eh.size&&(this.yh.Ro()?this.yh.po():this.Ph()&&this.ph.set("Unknown"))},xc.prototype.Oe=function(t){return this.Eh.get(t)||null},xc.prototype.xe=function(t){return this.Wh.xe(t)},xc.prototype.qh=function(t){this.mh.de(t.targetId),this.yh.Lo(t)},xc.prototype.Bh=function(t){this.mh.de(t),this.yh.Mo(t)},xc.prototype.kh=function(){this.mh=new eo(this),this.yh.start(),this.ph.uh()},xc.prototype.Nh=function(){return this.Ph()&&!this.yh.Ao()&&0<this.Eh.size},xc.prototype.Ph=function(){return 0===this.Ih.size},xc.prototype.Lh=function(){this.mh=null},xc.prototype.gh=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.Eh.forEach(function(t,e){n.qh(t)}),[2]})})},xc.prototype.vh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Lh(),this.Nh()?(this.ph.fh(e),this.kh()):this.ph.set("Unknown"),[2]})})},xc.prototype.bh=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:if(this.ph.set("Online"),!(i instanceof $i&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Qh(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.jh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof zi?this.mh.Pe(i):i instanceof Yi?this.mh.Ce(i):this.mh.ye(i),o.isEqual(Xr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.wh.qi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Gh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.jh(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},xc.prototype.jh=function(n,r){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!cu(n))throw n;return this.Ih.add(1),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Offline"),r=r||function(){return e.wh.qi()},this.Vs.Gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Ih.delete(1),[4,this.$h()];case 2:return t.sent(),[2]}})})}),[2]}})})},xc.prototype.Kh=function(e){var n=this;return e().catch(function(t){return n.jh(t,e)})},xc.prototype.Gh=function(r){var i=this,t=this.mh.$e(r);return t.Wt.forEach(function(t,e){if(0<t.resumeToken.H()){var n=i.Eh.get(e);n&&i.Eh.set(e,n.tt(t.resumeToken,r))}}),t.Qt.forEach(function(t){var e=i.Eh.get(t);if(e){i.Eh.set(t,e.tt(vi.Y,e.J)),i.Bh(t);var n=new Ei(e.target,t,1,e.sequenceNumber);i.qh(n)}}),this.Wh.Ui(t)},xc.prototype.Qh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Eh.has(i)?[4,this.Wh.zh(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Eh.delete(i),this.mh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},xc.prototype.xh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=0<this.Th.length?this.Th[this.Th.length-1].batchId:-1,t.label=1;case 1:if(!this.Hh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.wh.nr(e)];case 3:return null===(n=t.sent())?(0===this.Th.length&&this.Sh.po(),[3,7]):(e=n.batchId,this.Yh(n),[3,6]);case 4:return r=t.sent(),[4,this.jh(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Xh()&&this.Jh(),[2]}})})},xc.prototype.Hh=function(){return this.Ph()&&this.Th.length<10},xc.prototype.Zh=function(){return this.Th.length},xc.prototype.Yh=function(t){this.Th.push(t),this.Sh.Ro()&&this.Sh.Uo&&this.Sh.Bo(t.mutations)},xc.prototype.Xh=function(){return this.Ph()&&!this.Sh.Ao()&&0<this.Th.length},xc.prototype.Jh=function(){this.Sh.start()},xc.prototype.Ch=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Sh.jo(),[2]})})},xc.prototype.Fh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){for(e=0,n=this.Th;e<n.length;e++)r=n[e],this.Sh.Bo(r.mutations);return[2]})})},xc.prototype.Wo=function(i,o){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Th.shift(),n=Wa.from(e,i,o),[4,this.Kh(function(){return r.Wh.ta(n)})];case 1:return t.sent(),[4,this.xh()];case 2:return t.sent(),[2]}})})},xc.prototype.Dh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Sh.Uo?[4,this.ea(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Xh()&&this.Jh(),[2]}})})},xc.prototype.ea=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return Ti(n=i.code)&&n!==zr.ABORTED?(e=this.Th.shift(),this.Sh.Vo(),[4,this.Kh(function(){return r.Wh.na(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.xh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},xc.prototype.sa=function(){return new yc(this.Yo)},xc.prototype.Vh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ih.add(4),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Unknown"),this.Sh.Vo(),this.yh.Vo(),this.Ih.delete(4),[4,this.$h()];case 2:return t.sent(),[2]}})})},xc.prototype.ia=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vs.Hs(),Nr("RemoteStore","RemoteStore received new credentials"),this.Ih.add(3),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Unknown"),[4,this.Wh.ia(e)];case 2:return t.sent(),this.Ih.delete(3),[4,this.$h()];case 3:return t.sent(),[2]}})})},xc.prototype.ra=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Ih.delete(2),[4,this.$h()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Ih.add(2),[4,this.Oh()]);case 3:t.sent(),this.ph.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},xc),mc=(Mc.prototype.oa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Mc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Mc.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Mc),wc=(Uc.prototype.la=function(t){},Uc.prototype._a=function(t,e,n){},Uc.prototype.fa=function(t){return this.ua.oa(t),this.ca[t]||"not-current"},Uc.prototype.da=function(t,e,n){this.ca[t]=e},Uc.prototype.wa=function(t){this.ua.ha(t)},Uc.prototype.Ta=function(t){return this.ua.activeTargetIds.has(t)},Uc.prototype.Ea=function(t){delete this.ca[t]},Uc.prototype.ma=function(){return this.ua.activeTargetIds},Uc.prototype.Ia=function(t){return this.ua.activeTargetIds.has(t)},Uc.prototype.start=function(){return this.ua=new mc,Promise.resolve()},Uc.prototype.Vi=function(t,e,n){},Uc.prototype.Aa=function(t){},Uc.prototype.Mh=function(){},Uc.prototype.es=function(t){},Uc),bc=(Object.defineProperty(Cc.prototype,"ga",{get:function(){return this.Ra},enumerable:!1,configurable:!0}),Cc.prototype.va=function(t,e){var a=this,u=e?e.ba:new Qi,h=e?e.ya:this.ya,c=e?e.Mt:this.Mt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=e instanceof Js?e:null;r=r&&(ga(a.query,r)?r:null);var i=!!n&&a.Mt.has(n.key),o=!!r&&(r.Ge||a.Mt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.Sa(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.pa(r,p)||d&&a.pa(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),u.track({type:1,doc:n})}return{ya:l,ba:u,Ca:f,Mt:c}},Cc.prototype.Sa=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Cc.prototype.Da=function(t,e,n){var o=this,r=this.ya;this.ya=t.ya,this.Mt=t.Mt;var i=t.ba.Ot();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pa(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}}var r,i}),this.Fa(n);var s=e?this.$a():[],a=0===this.Va.size&&this.Ht?1:0,u=a!==this.Pa;return this.Pa=a,0!==i.length||u?{snapshot:new Ki(this.query,t.ya,r,i,t.Mt,0==a,u,!1),Na:s}:{Na:s}},Cc.prototype.ka=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Da({ya:this.ya,ba:new Qi,Mt:this.Mt,Ca:!1},!1)):{Na:[]}},Cc.prototype.xa=function(t){return!this.Ra.has(t)&&!!this.ya.has(t)&&!this.ya.get(t).Ge},Cc.prototype.Fa=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Ra=e.Ra.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Ra=e.Ra.delete(t)}),this.Ht=t.Ht)},Cc.prototype.$a=function(){var e=this;if(!this.Ht)return[];var n=this.Va;this.Va=Gi(),this.ya.forEach(function(t){e.xa(t.key)&&(e.Va=e.Va.add(t.key))});var r=[];return n.forEach(function(t){e.Va.has(t)||r.push(new Zh(t))}),this.Va.forEach(function(t){n.has(t)||r.push(new Jh(t))}),r},Cc.prototype.Oa=function(t){this.Ra=t._r,this.Va=Gi();var e=this.va(t.documents);return this.Da(e,!0)},Cc.prototype.La=function(){return Ki.Bt(this.query,this.ya,this.Mt,0===this.Pa)},Cc),Ec=(kc.prototype.run=function(){this.qa()},kc.prototype.qa=function(){var t=this;this.Ls.fs(function(){return d(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new yc(this.Yo),(n=this.Ua(e))&&n.then(function(t){r.Vs.Cs(function(){return e.commit().then(function(){r.gs.resolve(t)}).catch(function(t){r.Ba(t)})})}).catch(function(t){r.Ba(t)}),[2]})})})},kc.prototype.Ua=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.gs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gs.reject(t),null}},kc.prototype.Ba=function(t){var e=this;0<this.Ma&&this.Wa(t)?(--this.Ma,this.Vs.Cs(function(){return e.qa(),Promise.resolve()})):this.gs.reject(t)},kc.prototype.Wa=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ti(e)},kc),Ic=(Object.defineProperty(Vc.prototype,"ru",{get:function(){return!0===this.iu},enumerable:!1,configurable:!0}),Vc.prototype.subscribe=function(t){this.za=t},Vc.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.ou("listen()"),(r=this.Ha.get(s))?(e=r.targetId,this.Ga.fa(e),n=r.view.La(),[3,4]):[3,1];case 1:return[4,this.wh.rr(ca(s))];case 2:return i=t.sent(),o=this.Ga.fa(i.targetId),e=i.targetId,[4,this.hu(s,e,"current"===o)];case 3:n=t.sent(),this.ru&&this.ja.listen(i),t.label=4;case 4:return[2,n]}})})},Vc.prototype.hu=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.wh.cr(a,!0)];case 1:return e=t.sent(),n=new bc(a,e._r),r=n.va(e.documents),i=Zi.zt(u,h&&"Offline"!==this.onlineState),o=n.Da(r,this.ru,i),this.au(u,o.Na),s=new tc(a,u,n),[2,(this.Ha.set(a,s),this.Ya.has(u)?this.Ya.get(u).push(a):this.Ya.set(u,[a]),o.snapshot)]}})})},Vc.prototype.Uh=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.ou("unlisten()"),e=this.Ha.get(i),1<(n=this.Ya.get(e.targetId)).length?[2,(this.Ya.set(e.targetId,n.filter(function(t){return!da(t,i)})),void this.Ha.delete(i))]:this.ru?(this.Ga.wa(e.targetId),this.Ga.Ia(e.targetId)?[3,2]:[4,this.wh.ur(e.targetId,!1).then(function(){r.Ga.Ea(e.targetId),r.ja.Uh(e.targetId),r.uu(e.targetId)}).catch(Eu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.uu(e.targetId),[4,this.wh.ur(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Vc.prototype.write=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:this.ou("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.wh.bi(i)];case 2:return e=t.sent(),this.Ga.la(e.batchId),this.cu(e.batchId,o),[4,this.lu(e.Ci)];case 3:return t.sent(),[4,this.ja.xh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=vu(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Vc.prototype.runTransaction=function(t,e,n){new Ec(t,this.Yo,e,n).run()},Vc.prototype.Ui=function(n){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.ou("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.wh.Ui(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Za.get(e);n&&(Rr(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.Qa=!0:0<t.Xt.size?Rr(n.Qa):0<t.Jt.size&&(Rr(n.Qa),n.Qa=!1))}),[4,this.lu(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Eu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Vc.prototype.ka=function(r,t){if(this.ru&&0===t||!this.ru&&1===t){this.ou("applyOnlineStateChange()");var i=[];this.Ha.forEach(function(t,e){var n=e.view.ka(r);n.snapshot&&i.push(n.snapshot)}),this.za._u(r),this.za.Oo(i),this.onlineState=r,this.ru&&this.Ga.Aa(r)}},Vc.prototype.zh=function(a,u){return d(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ou("rejectListens()"),this.Ga.da(a,"rejected",u),e=this.Za.get(a),(n=e&&e.key)?(r=(r=new Ni(ti.P)).nt(n,new Zs(n,Xr.min())),i=Gi().add(n),o=new Ji(Xr.min(),new Map,new Pi(kr),r,i),[4,this.Ui(o)]):[3,2];case 1:return t.sent(),this.Ja=this.Ja.remove(n),this.Za.delete(a),this.fu(),[3,4];case 2:return[4,this.wh.ur(a,!1).then(function(){return s.uu(a,u)}).catch(Eu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Vc.prototype.ta=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.ou("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.wh.Di(r)];case 2:return n=t.sent(),this.du(e,null),this.wu(e),this.Ga._a(e,"acknowledged"),[4,this.lu(n)];case 3:return t.sent(),[3,6];case 4:return[4,Eu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Vc.prototype.na=function(n,r){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.ou("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.wh.xi(n)];case 2:return e=t.sent(),this.du(n,r),this.wu(n),this.Ga._a(n,"rejected",r),[4,this.lu(e)];case 3:return t.sent(),[3,6];case 4:return[4,Eu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Vc.prototype.Tu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:this.ja.Ph()||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.wh.Mi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.nu.get(e)||[]).push(o),this.nu.set(e,n),[3,4]);case 3:return r=t.sent(),i=vu(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Vc.prototype.wu=function(t){(this.nu.get(t)||[]).forEach(function(t){t.resolve()}),this.nu.delete(t)},Vc.prototype.Eu=function(e){this.nu.forEach(function(t){t.forEach(function(t){t.reject(new Yr(zr.CANCELLED,e))})}),this.nu.clear()},Vc.prototype.cu=function(t,e){var n=this.eu[this.currentUser.to()];n=(n=n||new Ni(kr)).nt(t,e),this.eu[this.currentUser.to()]=n},Vc.prototype.du=function(t,e){var n=this.eu[this.currentUser.to()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.eu[this.currentUser.to()]=n}},Vc.prototype.uu=function(t,e){var n=this;void 0===e&&(e=null),this.Ga.wa(t);for(var r=0,i=this.Ya.get(t);r<i.length;r++){var o=i[r];this.Ha.delete(o),e&&this.za.mu(o,e)}this.Ya.delete(t),this.ru&&this.tu.Vr(t).forEach(function(t){n.tu.gr(t)||n.Iu(t)})},Vc.prototype.Iu=function(t){var e=this.Ja.get(t);null!==e&&(this.ja.Uh(e),this.Ja=this.Ja.remove(t),this.Za.delete(e),this.fu())},Vc.prototype.au=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Jh?(this.tu.tr(i.key,t),this.Au(i)):i instanceof Zh?(Nr("SyncEngine","Document no longer in limbo: "+i.key),this.tu.er(i.key,t),this.tu.gr(i.key)||this.Iu(i.key)):Dr()}},Vc.prototype.Au=function(t){var e=t.key;this.Ja.get(e)||(Nr("SyncEngine","New document in limbo: "+e),this.Xa.push(e),this.fu())},Vc.prototype.fu=function(){for(;0<this.Xa.length&&this.Ja.size<this.Ka;){var t=this.Xa.shift(),e=this.su.next();this.Za.set(e,new ec(t)),this.Ja=this.Ja.nt(t,e),this.ja.listen(new Ei(ca(aa(t.path)),e,2,$a.ns))}},Vc.prototype.Ru=function(){return this.Ja},Vc.prototype.Pu=function(){return this.Xa},Vc.prototype.lu=function(r,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Ha.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.va(r);return n.Ca?a.wh.cr(i.query,!1).then(function(t){var e=t.documents;return i.view.va(e,n)}):n}).then(function(t){var e=u&&u.Wt.get(i.targetId),n=i.view.Da(t,a.ru,e);if(a.au(i.targetId,n.Na),n.snapshot){a.ru&&a.Ga.da(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=Ya.Xn(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.za.Oo(o),[4,this.wh.Zi(s)];case 2:return t.sent(),[2]}})})},Vc.prototype.ou=function(t){},Vc.prototype.ia=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Nr("SyncEngine","User change. New user:",n.to()),[4,this.wh.Vi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.Eu("'waitForPendingWrites' promise is rejected due to a user change."),this.Ga.Vi(n,e.gi,e.vi),[4,this.lu(e.yi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Vc.prototype.xe=function(t){var e=this.Za.get(t);if(e&&e.Qa)return Gi().add(e.key);var n=Gi(),r=this.Ya.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.Ha.get(s);n=n.Dt(a.view.ga)}return n},Vc),Tc=(Pc.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(r=this.pu.get(e))||(n=!0,r=new nc),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Wh.listen(e)];case 2:return i.Vu=t.sent(),[3,4];case 3:return o=t.sent(),s=vu(o,"Initialization of query '"+va(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.pu.set(e,r),r.listeners.push(a),a.ka(this.onlineState),r.Vu&&a.gu(r.Vu)&&this.vu(),[2]}})})},Pc.prototype.Uh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.pu.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.pu.delete(e),this.Wh.Uh(e))]:[2]})})},Pc.prototype.Oo=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.pu.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].gu(i)&&(e=!0);s.Vu=i}}e&&this.vu()},Pc.prototype.mu=function(t,e){var n=this.pu.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.pu.delete(t)},Pc.prototype._u=function(i){this.onlineState=i;var o=!1;this.pu.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].ka(i)&&(o=!0)}),o&&this.vu()},Pc.prototype.bu=function(t){this.yu.add(t),t.next()},Pc.prototype.Su=function(t){this.yu.delete(t)},Pc.prototype.vu=function(){this.yu.forEach(function(t){t.next()})},Pc),Ac=(Oc.prototype.gu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ki(t.query,t.docs,t.Lt,e,t.Mt,t.fromCache,t.qt,!0)}var o=!1;return this.Du?this.$u(t)&&(this.Cu.next(t),o=!0):this.Nu(t,this.onlineState)&&(this.ku(t),o=!0),this.Fu=t,o},Oc.prototype.onError=function(t){this.Cu.error(t)},Oc.prototype.ka=function(t){this.onlineState=t;var e=!1;return this.Fu&&!this.Du&&this.Nu(this.Fu,t)&&(this.ku(this.Fu),e=!0),e},Oc.prototype.Nu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.xu&&n||t.docs._()&&"Offline"!==e)},Oc.prototype.$u=function(t){if(0<t.docChanges.length)return!0;var e=this.Fu&&this.Fu.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Oc.prototype.ku=function(t){t=Ki.Bt(t.query,t.docs,t.Mt,t.fromCache),this.Du=!0,this.Cu.next(t)},Oc),Nc=(Lc.prototype.Pi=function(t){this.Ou=t},Lc.prototype.Bn=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Xr.min())?this.Lu(e,r):this.Ou.Mn(e,o).next(function(t){var n=s.Mu(r,t);return(r.hn()||r.an())&&s.Ca(r.en,n,o,i)?s.Lu(e,r):(Ar()<=p.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),va(r)),s.Ou.Bn(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Lc.prototype.Mu=function(n,t){var r=new Pi(ma(n));return t.forEach(function(t,e){e instanceof Js&&ga(n,e)&&(r=r.add(e))}),r},Lc.prototype.Ca=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Lc.prototype.Lu=function(t,e){return Ar()<=p.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",va(e)),this.Ou.Bn(t,e,Xr.min())},Lc),_c=(Rc.prototype.Bu=function(t){return Ha.resolve(0===this.Fn.length)},Rc.prototype.Si=function(t,e,n,r){var i=this.qu;this.qu++,0<this.Fn.length&&this.Fn[this.Fn.length-1];var o=new Ga(i,e,n,r);this.Fn.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Uu=this.Uu.add(new Tu(u.key,i)),this.$n.Is(t,u.key.path.g())}return Ha.resolve(o)},Rc.prototype.Oi=function(t,e){return Ha.resolve(this.Wu(e))},Rc.prototype.sr=function(t,e){var n=e+1,r=this.Qu(n),i=r<0?0:r;return Ha.resolve(this.Fn.length>i?this.Fn[i]:null)},Rc.prototype.Mi=function(){return Ha.resolve(0===this.Fn.length?-1:this.qu-1)},Rc.prototype.pi=function(t){return Ha.resolve(this.Fn.slice())},Rc.prototype.kn=function(t,e){var n=this,r=new Tu(e,0),i=new Tu(e,Number.POSITIVE_INFINITY),o=[];return this.Uu.bt([r,i],function(t){var e=n.Wu(t.vr);o.push(e)}),Ha.resolve(o)},Rc.prototype.Un=function(t,e){var r=this,i=new Pi(kr);return e.forEach(function(t){var e=new Tu(t,0),n=new Tu(t,Number.POSITIVE_INFINITY);r.Uu.bt([e,n],function(t){i=i.add(t.vr)})}),Ha.resolve(this.ju(i))},Rc.prototype.Kn=function(t,e){var n=e.path,r=n.length+1,i=n;ti.W(i)||(i=i.child(""));var o=new Tu(new ti(i),0),s=new Pi(kr);return this.Uu.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===r&&(s=s.add(t.vr)),!0)},o),Ha.resolve(this.ju(s))},Rc.prototype.ju=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Wu(t);null!==e&&r.push(e)}),r},Rc.prototype.Li=function(n,r){var i=this;Rr(0===this.Gu(r.batchId,"removed")),this.Fn.shift();var o=this.Uu;return Ha.forEach(r.mutations,function(t){var e=new Tu(t.key,r.batchId);return o=o.delete(e),i.Yi.Ku(n,t.key)}).next(function(){i.Uu=o})},Rc.prototype.zu=function(t){},Rc.prototype.gr=function(t,e){var n=new Tu(e,0),r=this.Uu.Ct(n);return Ha.resolve(e.isEqual(r&&r.key))},Rc.prototype.ki=function(t){return this.Fn.length,Ha.resolve()},Rc.prototype.Gu=function(t,e){return this.Qu(t)},Rc.prototype.Qu=function(t){return 0===this.Fn.length?0:t-this.Fn[0].batchId},Rc.prototype.Wu=function(t){var e=this.Qu(t);return e<0||e>=this.Fn.length?null:this.Fn[e]},Rc),Sc=(Dc.prototype.zi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Hu(e);return this.docs=this.docs.nt(r,{Yu:e,size:s,readTime:n}),this.size+=s-o,this.$n.Is(t,r.path.g())},Dc.prototype.Ki=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Dc.prototype.On=function(t,e){var n=this.docs.get(e);return Ha.resolve(n?n.Yu:null)},Dc.prototype.getEntries=function(t,e){var n=this,r=xi();return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Yu:null)}),Ha.resolve(r)},Dc.prototype.Bn=function(t,e,n){for(var r=ji(),i=new ti(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u.Yu,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof Js&&ga(e,h)&&(r=r.nt(h.key,h))}return Ha.resolve(r)},Dc.prototype.Xu=function(t,e){return Ha.forEach(this.docs,function(t){return e(t)})},Dc.prototype.Fi=function(t){return new Dc.Ju(this)},Dc.prototype.Zu=function(t){return Ha.resolve(this.size)},Dc);function Dc(t,e){this.$n=t,this.Hu=e,this.docs=new Ni(ti.P),this.size=0}function Rc(t,e){this.$n=t,this.Yi=e,this.Fn=[],this.qu=1,this.Uu=new Pi(Tu.Er)}function Lc(){}function Oc(t,e,n){this.query=t,this.Cu=e,this.Du=!1,this.Fu=null,this.onlineState="Unknown",this.options=n||{}}function Pc(t){this.Wh=t,this.pu=new Hr(function(t){return ya(t)},da),this.onlineState="Unknown",this.yu=new Set,this.Wh.subscribe(this)}function Vc(t,e,n,r,i,o){this.wh=t,this.ja=e,this.Yo=n,this.Ga=r,this.currentUser=i,this.Ka=o,this.za=null,this.Ha=new Hr(function(t){return ya(t)},da),this.Ya=new Map,this.Xa=[],this.Ja=new Ni(ti.P),this.Za=new Map,this.tu=new Iu,this.eu={},this.nu=new Map,this.su=ou.Ps(),this.onlineState="Unknown",this.iu=void 0}function kc(t,e,n,r){this.Vs=t,this.Yo=e,this.updateFunction=n,this.gs=r,this.Ma=5,this.Ls=new nu(this.Vs,"transaction_retry")}function Cc(t,e){this.query=t,this.Ra=e,this.Pa=null,this.Ht=!1,this.Va=Gi(),this.Mt=Gi(),this.pa=ma(t),this.ya=new Xi(this.pa)}function Uc(){this.ua=new mc,this.ca={},this.rh=null,this.Jn=null}function Mc(){this.activeTargetIds=Hi()}function xc(t,e,n,r,i){var o,s,a,u,h,c,l,f,p=this;this.wh=t,this.Yo=e,this.Vs=n,this.Th=[],this.Eh=new Map,this.mh=null,this.Ih=new Set,this.Ah=i,this.Ah.Rh(function(t){n.Cs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ph()?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,this.Vh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ph=new vc(n,r),this.yh=(h=this.Yo,c=n,l={ko:this.gh.bind(this),Co:this.vh.bind(this),Oo:this.bh.bind(this)},(f=Lr(h)).Ko(),new fc(c,f.To,f.credentials,f.serializer,l)),this.Sh=(o=this.Yo,s=n,a={ko:this.Ch.bind(this),Co:this.Dh.bind(this),Qo:this.Fh.bind(this),Wo:this.Wo.bind(this)},(u=Lr(o)).Ko(),new pc(s,u.To,u.credentials,u.serializer,a))}function Fc(t,e){this.Vs=t,this.rh=e,this.state="Unknown",this.oh=0,this.hh=null,this.ah=!0}function jc(t){this.Yo=t,this.Xo=new Map,this.mutations=[],this.Jo=!1,this.Zo=null,this.th=new Set}function qc(t,e){var n=this;return(n=rc.call(this)||this).credentials=t,n.serializer=e,n.Go=!1,n}function Bc(t,e,n,r,i){var o=this;return(o=ic.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.qo=!1,o}function Gc(t,e,n,r,i){var o=this;return(o=oc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Wc(t,e,n,r,i,o){this.ss=t,this.wo=n,this.To=r,this.Eo=i,this.listener=o,this.state=0,this.mo=0,this.Io=null,this.stream=null,this.Ls=new nu(t,e)}function Hc(t,e){this._o=t,this.fo=e}function zc(t,e){this._o=t,this.fo=e,this.type="FirstParty",this.user=Xh.no}function Yc(t){var e=this;this.ao=null,this.currentUser=Xh.UNAUTHENTICATED,this.uo=!1,this.co=0,this.io=null,this.forceRefresh=!1,this.ao=function(){e.co++,e.currentUser=e.lo(),e.uo=!0,e.io&&e.io(e.currentUser)},this.co=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ao):(this.ao(null),t.get().then(function(t){e.auth=t,e.ao&&e.auth.addAuthTokenListener(e.ao)},function(){}))}function $c(){this.io=null}function Xc(t){var e=this;return(e=sc.call(this)||this).rc=t,e}function Qc(){this.Ci=new Hr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.tc=!1}Sc.Ju=(Object.defineProperty(Qc.prototype,"readTime",{get:function(){return this.ec},set:function(t){this.ec=t},enumerable:!1,configurable:!0}),Qc.prototype.zi=function(t,e){this.nc(),this.readTime=e,this.Ci.set(t.key,t)},Qc.prototype.Ki=function(t,e){this.nc(),e&&(this.readTime=e),this.Ci.set(t,null)},Qc.prototype.On=function(t,e){this.nc();var n=this.Ci.get(e);return void 0!==n?Ha.resolve(n):this.sc(t,e)},Qc.prototype.getEntries=function(t,e){return this.ic(t,e)},Qc.prototype.apply=function(t){return this.nc(),this.tc=!0,this.Da(t)},Qc.prototype.nc=function(){},n(Xc,sc=Qc),Xc.prototype.Da=function(n){var r=this,i=[];return this.Ci.forEach(function(t,e){e?i.push(r.rc.zi(n,e,r.readTime)):r.rc.Ki(t)}),Ha.Sn(i)},Xc.prototype.sc=function(t,e){return this.rc.On(t,e)},Xc.prototype.ic=function(t,e){return this.rc.getEntries(t,e)},Xc);var Kc,Jc=(Tl.prototype.ge=function(t,n){return this.oc.forEach(function(t,e){return n(e)}),Ha.resolve()},Tl.prototype.qi=function(t){return Ha.resolve(this.lastRemoteSnapshotVersion)},Tl.prototype.cc=function(t){return Ha.resolve(this.hc)},Tl.prototype.hr=function(t){return this.highestTargetId=this.uc.next(),Ha.resolve(this.highestTargetId)},Tl.prototype.Xi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.hc&&(this.hc=e),Ha.resolve()},Tl.prototype.lc=function(t){this.oc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.uc=new ou(e),this.highestTargetId=e),t.sequenceNumber>this.hc&&(this.hc=t.sequenceNumber)},Tl.prototype.ar=function(t,e){return this.lc(e),this.targetCount+=1,Ha.resolve()},Tl.prototype.Gi=function(t,e){return this.lc(e),Ha.resolve()},Tl.prototype._c=function(t,e){return this.oc.delete(e.target),this.ac.Vr(e.targetId),--this.targetCount,Ha.resolve()},Tl.prototype.fc=function(n,r,i){var o=this,s=0,a=[];return this.oc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.oc.delete(t),a.push(o.dc(n,e.targetId)),s++)}),Ha.Sn(a).next(function(){return s})},Tl.prototype.wc=function(t){return Ha.resolve(this.targetCount)},Tl.prototype.or=function(t,e){var n=this.oc.get(e)||null;return Ha.resolve(n)},Tl.prototype.Wi=function(t,e,n){return this.ac.Ar(e,n),Ha.resolve()},Tl.prototype.Bi=function(e,t,n){this.ac.Pr(t,n);var r=this.persistence.Yi,i=[];return r&&t.forEach(function(t){i.push(r.Ku(e,t))}),Ha.Sn(i)},Tl.prototype.dc=function(t,e){return this.ac.Vr(e),Ha.resolve()},Tl.prototype.lr=function(t,e){var n=this.ac.yr(e);return Ha.resolve(n)},Tl.prototype.gr=function(t,e){return Ha.resolve(this.ac.gr(e))},Tl),Zc=(Il.prototype.start=function(){return Promise.resolve()},Il.prototype.Mh=function(){return this.mc=!1,Promise.resolve()},Object.defineProperty(Il.prototype,"Ac",{get:function(){return this.mc},enumerable:!1,configurable:!0}),Il.prototype.Rc=function(){},Il.prototype.Pc=function(){},Il.prototype.Ri=function(){return this.$n},Il.prototype.wi=function(t){var e=this.Tc[t.to()];return e||(e=new _c(this.$n,this.Yi),this.Tc[t.to()]=e),e},Il.prototype.Ii=function(){return this.mi},Il.prototype.Ei=function(){return this.Dn},Il.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new tl(this.Ec.next());return this.Yi.Vc(),n(i).next(function(t){return r.Yi.pc(i).next(function(){return t})}).vn().then(function(t){return i.yc(),t})},Il.prototype.gc=function(e,n){return Ha.Cn(Object.values(this.Tc).map(function(t){return function(){return t.gr(e,n)}}))},Il),tl=(El.prototype.bc=function(t){this.vc.push(t)},El.prototype.yc=function(){this.vc.forEach(function(t){return t()})},n(bl,Kc=El),bl),el=(wl.Dc=function(t){return new wl(t)},Object.defineProperty(wl.prototype,"Fc",{get:function(){if(this.Cc)return this.Cc;throw Dr()},enumerable:!1,configurable:!0}),wl.prototype.tr=function(t,e,n){return this.Sc.tr(n,e),this.Fc.delete(n),Ha.resolve()},wl.prototype.er=function(t,e,n){return this.Sc.er(n,e),this.Fc.add(n),Ha.resolve()},wl.prototype.Ku=function(t,e){return this.Fc.add(e),Ha.resolve()},wl.prototype.removeTarget=function(t,e){var n=this;this.Sc.Vr(e.targetId).forEach(function(t){return n.Fc.add(t)});var r=this.persistence.Ii();return r.lr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Fc.add(t)})}).next(function(){return r._c(t,e)})},wl.prototype.Vc=function(){this.Cc=new Set},wl.prototype.pc=function(t){var n=this,r=this.persistence.Ei().Fi();return Ha.forEach(this.Fc,function(e){return n.$c(t,e).next(function(t){t||r.Ki(e)})}).next(function(){return n.Cc=null,r.apply(t)})},wl.prototype.Hi=function(t,e){var n=this;return this.$c(t,e).next(function(t){t?n.Fc.delete(e):n.Fc.add(e)})},wl.prototype.Ic=function(t){return 0},wl.prototype.$c=function(t,e){var n=this;return Ha.Cn([function(){return Ha.resolve(n.Sc.gr(e))},function(){return n.persistence.Ii().gr(t,e)},function(){return n.persistence.gc(t,e)}])},wl),nl=(ml.prototype.ko=function(t){this.xc=t},ml.prototype.Co=function(t){this.Oc=t},ml.prototype.onMessage=function(t){this.Lc=t},ml.prototype.close=function(){this.kc()},ml.prototype.send=function(t){this.Nc(t)},ml.prototype.Mc=function(){this.xc()},ml.prototype.qc=function(t){this.Oc(t)},ml.prototype.Uc=function(t){this.Lc(t)},ml),rl={BatchGetDocuments:"batchGet",Commit:"commit"},il="gl-js/ fire/"+Ir,ol=(gl.prototype.Wc=function(t,e){if(e)for(var n in e.so)e.so.hasOwnProperty(n)&&(t[n]=e.so[n]);t["X-Goog-Api-Client"]=il},gl.prototype.zo=function(u,r,i){var h=this,c=this.Qc(u);return new Promise(function(o,s){var a=new wr;a.listenOnce(gr.COMPLETE,function(){try{switch(a.getLastErrorCode()){case vr.NO_ERROR:var t=a.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case vr.TIMEOUT:Nr("Connection",'RPC "'+u+'" timed out'),s(new Yr(zr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=a.getStatus();if(Nr("Connection",'RPC "'+u+'" failed with status:',e,"response text:",a.getResponseText()),0<e){var n=a.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(zr).indexOf(i)?i:zr.UNKNOWN);s(new Yr(r,n.message))}else s(new Yr(zr.UNKNOWN,"Server responded with status "+a.getStatus()))}else Nr("Connection",'RPC "'+u+'" failed'),s(new Yr(zr.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Nr("Connection",'RPC "'+u+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Nr("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Wc(n,i),a.send(c,"POST",e,n,15)})},gl.prototype.Ho=function(t,e,n){return this.zo(t,e,n)},gl.prototype.xo=function(t,e){var n,r,i=[this.Bc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=yr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Wc(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Nr("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new nl({Nc:function(t){l?Nr("Connection","Not sending because WebChannel is closed:",t):(c||(Nr("Connection","Opening WebChannel transport."),h.open(),c=!0),Nr("Connection","WebChannel sending:",t),h.send(t))},kc:function(){return h.close()}});return u(mr.EventType.OPEN,function(){l||Nr("Connection","WebChannel transport opened.")}),u(mr.EventType.CLOSE,function(){l||(l=!0,Nr("Connection","WebChannel transport closed"),f.qc())}),u(mr.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Tr.logLevel<=p.WARN){var r=e.map(Sr);Tr.warn.apply(Tr,v(["Firestore ("+Ir+"): Connection"],r))}}("Connection","WebChannel transport errored:",t),f.qc(new Yr(zr.UNAVAILABLE,"The operation could not be completed")))}),u(mr.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];Rr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Nr("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=wi[i];if(void 0!==t)return Ai(t)}(),s=r.message;void 0===o&&(o=zr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.qc(new Yr(o,s)),h.close()}else Nr("Connection","WebChannel received:",n),f.Uc(n)}}),setTimeout(function(){f.Mc()},0),f},gl.prototype.Qc=function(t){var e=rl[t];return this.Bc+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},gl),sl=(vl.prototype.Rh=function(t){this.Hc.push(t)},vl.prototype.Mh=function(){window.removeEventListener("online",this.jc),window.removeEventListener("offline",this.Kc)},vl.prototype.Yc=function(){window.addEventListener("online",this.jc),window.addEventListener("offline",this.Kc)},vl.prototype.Gc=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Hc;t<e.length;t++)(0,e[t])(0)},vl.prototype.zc=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Hc;t<e.length;t++)(0,e[t])(1)},vl.Xc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},vl),al=(yl.prototype.Rh=function(t){},yl.prototype.Mh=function(){},yl),ul="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",hl=(dl.prototype.initialize=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return this.Ga=this.Jc(r),this.persistence=this.Zc(r),[4,this.persistence.start()];case 1:return t.sent(),this.tl=this.el(r),this.wh=this.nl(r),this.Yo=this.sl(r),[4,this.il(r)];case 2:return e=t.sent(),this.Yo.start(e),this.ja=this.rl(r),this.Wh=this.ol(r),this.hl=this.al(r),this.Ga.rh=function(t){return n.Wh.ka(t,1)},this.ja.Wh=this.Wh,[4,this.Ga.start()];case 3:return t.sent(),[4,this.ja.start()];case 4:return t.sent(),[4,this.ja.ra(this.Wh.ru)];case 5:return t.sent(),[2]}})})},dl.prototype.il=function(t){return e=t.ul,Promise.resolve(new ol(e));var e},dl.prototype.al=function(t){return new Tc(this.Wh)},dl.prototype.el=function(t){return null},dl.prototype.nl=function(t){return e=this.persistence,n=new Nc,r=t.cl,new wu(e,n,r);var e,n,r},dl.prototype.Zc=function(t){if(t._l.ll)throw new Yr(zr.FAILED_PRECONDITION,ul);return new Zc(el.Dc)},dl.prototype.sl=function(t){var e,n=Nh(t.ul.s);return e=t.credentials,new dc(e,n)},dl.prototype.rl=function(t){var e=this;return new gc(this.wh,this.Yo,t.Vs,function(t){return e.Wh.ka(t,0)},new(sl.Xc()?sl:al))},dl.prototype.Jc=function(t){return new wc},dl.prototype.ol=function(t){return e=this.wh,n=this.ja,r=this.Yo,i=this.Ga,o=t.cl,s=t.Ka,(a=new Ic(e,n,r,i,o,s)).iu=!0,a;var e,n,r,i,o,s,a},dl.prototype.clearPersistence=function(t,e){throw new Yr(zr.FAILED_PRECONDITION,ul)},dl),cl=(pl.prototype.start=function(t,e,n){var r=this;this.fl(),this.ul=t;var i=new eu,o=new eu,s=!1;return this.credentials.oo(function(t){if(!s)return s=!0,Nr("FirestoreClient","Initializing. user=",t.uid),r.dl(e,n,t,o).then(i.resolve,i.reject);r.Vs.Gs(function(){return r.ja.ia(t)})}),this.Vs.Cs(function(){return i.promise}),o.promise},pl.prototype.enableNetwork=function(){var t=this;return this.fl(),this.Vs.enqueue(function(){return t.persistence.Pc(!0),t.ja.enableNetwork()})},pl.prototype.dl=function(r,i,o,s){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r.initialize({Vs:this.Vs,ul:this.ul,clientId:this.clientId,credentials:this.credentials,cl:o,Ka:100,_l:i})];case 1:return t.sent(),this.persistence=r.persistence,this.Ga=r.Ga,this.wh=r.wh,this.ja=r.ja,this.Wh=r.Wh,this.tl=r.tl,this.wl=r.hl,this.persistence.Rc(function(){return d(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,3];case 2:if(e=t.sent(),s.reject(e),!this.Tl(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.dl(new hl,{ll:!1},o,s))];case 3:return[2]}})})},pl.prototype.Tl=function(t){return"FirebaseError"===t.name?t.code===zr.FAILED_PRECONDITION||t.code===zr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},pl.prototype.fl=function(){if(this.Vs.qs)throw new Yr(zr.FAILED_PRECONDITION,"The client has already been terminated.")},pl.prototype.disableNetwork=function(){var t=this;return this.fl(),this.Vs.enqueue(function(){return t.persistence.Pc(!1),t.ja.disableNetwork()})},pl.prototype.terminate=function(){var t=this;return this.Vs.js(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.tl&&this.tl.stop(),[4,this.ja.Mh()];case 1:return t.sent(),[4,this.Ga.Mh()];case 2:return t.sent(),[4,this.persistence.Mh()];case 3:return t.sent(),this.credentials.ho(),[2]}})})})},pl.prototype.waitForPendingWrites=function(){var t=this;this.fl();var e=new eu;return this.Vs.Cs(function(){return t.Wh.Tu(e)}),e.promise},pl.prototype.listen=function(t,e,n){var r=this;this.fl();var i=new Ac(t,e,n);return this.Vs.Cs(function(){return r.wl.listen(i)}),i},pl.prototype.Uh=function(t){var e=this;this.El||this.Vs.Cs(function(){return e.wl.Uh(t)})},pl.prototype.ml=function(o){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){switch(t.label){case 0:return this.fl(),i=new eu,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.wh.ir(o)];case 1:return(e=t.sent())instanceof Js?i.resolve(e):e instanceof Zs?i.resolve(null):i.reject(new Yr(zr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=vu(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},pl.prototype.Il=function(u){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return this.fl(),a=new eu,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.wh.cr(u,!0)];case 1:return e=t.sent(),n=new bc(u,e._r),r=n.va(e.documents),i=n.Da(r,!1),a.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=vu(o,"Failed to execute query '"+u+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})},pl.prototype.write=function(t){var e=this;this.fl();var n=new eu;return this.Vs.Cs(function(){return e.Wh.write(t,n)}),n.promise},pl.prototype.s=function(){return this.ul.s},pl.prototype.bu=function(t){var e=this;this.fl(),this.Vs.Cs(function(){return e.wl.bu(t),Promise.resolve()})},pl.prototype.Su=function(t){var e=this;this.El||this.Vs.Cs(function(){return e.wl.Su(t),Promise.resolve()})},Object.defineProperty(pl.prototype,"El",{get:function(){return this.Vs.qs},enumerable:!1,configurable:!0}),pl.prototype.transaction=function(t){var e=this;this.fl();var n=new eu;return this.Vs.Cs(function(){return e.Wh.runTransaction(e.Vs,t,n),Promise.resolve()}),n.promise},pl),ll=(fl.prototype.next=function(t){this.Al(this.observer.next,t)},fl.prototype.error=function(t){this.Al(this.observer.error,t)},fl.prototype.Rl=function(){this.muted=!0},fl.prototype.Al=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},fl);function fl(t){this.observer=t,this.muted=!1}function pl(t,e){this.credentials=t,this.Vs=e,this.clientId=Pr.t()}function dl(){}function yl(){}function vl(){var t=this;this.jc=function(){return t.Gc()},this.Kc=function(){return t.zc()},this.Hc=[],this.Yc()}function gl(t){this.s=t.s;var e=t.ssl?"https":"http";this.Bc=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function ml(t){this.Nc=t.Nc,this.kc=t.kc}function wl(t){this.persistence=t,this.Sc=new Iu,this.Cc=null}function bl(t){var e=this;return(e=Kc.call(this)||this).Qi=t,e}function El(){this.vc=[]}function Il(t){var e=this;this.Tc={},this.Ec=new $a(0),this.mc=!1,this.mc=!0,this.Yi=t(this),this.mi=new Jc(this),this.$n=new ru,this.Dn=new Sc(this.$n,function(t){return e.Yi.Ic(t)})}function Tl(t){this.persistence=t,this.oc=new Hr(function(t){return pi(t)},di),this.lastRemoteSnapshotVersion=Xr.min(),this.highestTargetId=0,this.hc=0,this.ac=new Iu,this.targetCount=0,this.uc=ou.Rs()}function Al(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Nl=(Ol.prototype.pl=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.yl(t.timestampValue);case 4:return this.gl(t);case 5:return t.stringValue;case 6:return new Xu(To(t.bytesValue));case 7:return this.vl(t.referenceValue);case 8:return this.bl(t.geoPointValue);case 9:return this.Sl(t.arrayValue);case 10:return this.Cl(t.mapValue);default:throw Dr()}},Ol.prototype.Cl=function(t){var n=this,r={};return jr(t.fields||{},function(t,e){r[t]=n.pl(e)}),r},Ol.prototype.bl=function(t){return new gh(Io(t.latitude),Io(t.longitude))},Ol.prototype.Sl=function(t){var e=this;return(t.values||[]).map(function(t){return e.pl(t)})},Ol.prototype.gl=function(t){switch(this.Pl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.pl(e);case"estimate":return this.yl(fo(t));default:return null}},Ol.prototype.yl=function(t){var e=Eo(t),n=new $r(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Ol.prototype.vl=function(t){var e=Kr.N(t);Rr($o(e));var n=new Mr(e.get(1),e.get(3)),r=new ti(e.p(5));return n.isEqual(this.s)||_r("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Vl(r)},Ol),_l=gu.oi,Sl=(Ll.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ll),Dl=(Object.defineProperty(Rl.prototype,"ql",{get:function(){return this.Ul||(this.Ul=new kh(this.Ur,this.Ml.ignoreUndefinedProperties)),this.Ul},enumerable:!1,configurable:!0}),Rl.prototype.settings=function(t){Su("Firestore.settings",arguments,1),Lu("Firestore.settings","object",1,t);var e=new Sl(t);if(this.Nl&&!this.Ml.isEqual(e))throw new Yr(zr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ml=e).credentials&&(this.Ol=function(t){if(!t)return new ac;switch(t.type){case"gapi":var e=t.Bl;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new cc(e,t.fo||"0");case"provider":return t.Bl;default:throw new Yr(zr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Rl.prototype.enableNetwork=function(){return this.$l(),this.Nl.enableNetwork()},Rl.prototype.disableNetwork=function(){return this.$l(),this.Nl.disableNetwork()},Rl.prototype.enablePersistence=function(t){var e,n;if(this.Nl)throw new Yr(zr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&_r("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Yr(zr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Wl(this.Ll,{ll:!0,cacheSizeBytes:this.Ml.cacheSizeBytes,synchronizeTabs:r,Ql:i})},Rl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Nl&&!this.Nl.El)throw new Yr(zr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new eu,[2,(this.Fl.Us(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Ll.clearPersistence(this.Ur,this.xl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Rl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Rl.prototype,"jl",{get:function(){return this.$l(),this.Nl.El},enumerable:!1,configurable:!0}),Rl.prototype.waitForPendingWrites=function(){return this.$l(),this.Nl.waitForPendingWrites()},Rl.prototype.onSnapshotsInSync=function(t){if(this.$l(),Al(t))return Pl(this.Nl,t);Lu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Pl(this.Nl,e)},Rl.prototype.$l=function(){return this.Nl||this.Wl(new hl,{ll:!1}),this.Nl},Rl.prototype.Gl=function(){return new Ur(this.Ur,this.xl,this.Ml.host,this.Ml.ssl,this.Ml.forceLongPolling)},Rl.prototype.Wl=function(t,e){var n=this.Gl();return this.Nl=new cl(this.Ol,this.Fl),this.Nl.start(n,t,e)},Rl.kl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yr(zr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yr(zr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Mr(n)},Object.defineProperty(Rl.prototype,"app",{get:function(){if(!this.Dl)throw new Yr(zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Dl},enumerable:!1,configurable:!0}),Rl.prototype.collection=function(t){return Su("Firestore.collection",arguments,1),Lu("Firestore.collection","non-empty string",1,t),this.$l(),new rf(Kr.N(t),this,null)},Rl.prototype.doc=function(t){return Su("Firestore.doc",arguments,1),Lu("Firestore.doc","non-empty string",1,t),this.$l(),Ul.Kl(Kr.N(t),this,null)},Rl.prototype.collectionGroup=function(t){if(Su("Firestore.collectionGroup",arguments,1),Lu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.$l(),new Jl((e=t,new oa(Kr.k(),e)),this,null);var e},Rl.prototype.runTransaction=function(e){var n=this;return Su("Firestore.runTransaction",arguments,1),Lu("Firestore.runTransaction","function",1,e),this.$l().transaction(function(t){return e(new kl(n,t))})},Rl.prototype.batch=function(){return this.$l(),new Cl(this)},Object.defineProperty(Rl,"logLevel",{get:function(){switch(Ar()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Rl.setLogLevel=function(t){Su("Firestore.setLogLevel",arguments,1),Cu("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Tr.setLogLevel(t)},Rl.prototype.zl=function(){return this.Ml.timestampsInSnapshots},Rl);function Rl(t,e,n){var r=this;if(void 0===n&&(n=new hl),this.Dl=null,this.Fl=new pu,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.$l(),[4,this.Nl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Dl=i,this.Ur=Rl.kl(i),this.xl=i.name,this.Ol=new uc(e)}else{var o=t;if(!o.projectId)throw new Yr(zr.INVALID_ARGUMENT,"Must provide projectId");this.Ur=new Mr(o.projectId,o.database),this.xl="[DEFAULT]",this.Ol=new ac}this.Ll=n,this.Ml=new Sl({})}function Ll(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(zr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Pu("settings","non-empty string","host",t.host),this.host=t.host,Vu("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ju("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Vu("settings","object","credentials",t.credentials),this.credentials=t.credentials,Vu("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Vu("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?_r("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&_r("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Vu("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=gu.ai;else{if(t.cacheSizeBytes!==_l&&t.cacheSizeBytes<gu.hi)throw new Yr(zr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+gu.hi);this.cacheSizeBytes=t.cacheSizeBytes}Vu("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Ol(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Pl=n,this.Vl=r}function Pl(t,e){var n=new ll({next:function(){e.next&&e.next()},error:function(t){throw Dr()}});return t.bu(n),function(){n.Rl(),t.Su(n)}}var Vl,kl=(Fl.prototype.get=function(t){var n=this;Su("Transaction.get",arguments,1);var r=cf("Transaction.get",t,this.Hl);return this.Yl.eh([r.Br]).then(function(t){if(!t||1!==t.length)return Dr();var e=t[0];if(e instanceof Zs)return new Gl(n.Hl,r.Br,null,!1,!1,r.Wr);if(e instanceof Js)return new Gl(n.Hl,r.Br,e,!1,!1,r.Wr);throw Dr()})},Fl.prototype.set=function(t,e,n){Ru("Transaction.set",arguments,2,3);var r=cf("Transaction.set",t,this.Hl);n=af("Transaction.set",n);var i=lf(r.Wr,e,n),o=Mh(this.Hl.ql,"Transaction.set",r.Br,i,null!==r.Wr,n);return this.Yl.set(r.Br,o),this},Fl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Ku?(Du("Transaction.update",arguments,3),r=cf("Transaction.update",t,this.Hl),Fh(this.Hl.ql,"Transaction.update",r.Br,e,n,o)):(Su("Transaction.update",arguments,2),r=cf("Transaction.update",t,this.Hl),xh(this.Hl.ql,"Transaction.update",r.Br,e)),this.Yl.update(r.Br,i),this},Fl.prototype.delete=function(t){Su("Transaction.delete",arguments,1);var e=cf("Transaction.delete",t,this.Hl);return this.Yl.delete(e.Br),this},Fl),Cl=(xl.prototype.set=function(t,e,n){Ru("WriteBatch.set",arguments,2,3),this.Zl();var r=cf("WriteBatch.set",t,this.Hl);n=af("WriteBatch.set",n);var i=lf(r.Wr,e,n),o=Mh(this.Hl.ql,"WriteBatch.set",r.Br,i,null!==r.Wr,n);return this.Xl=this.Xl.concat(o.Qr(r.Br,gs.je())),this},xl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Zl(),i="string"==typeof e||e instanceof Ku?(Du("WriteBatch.update",arguments,3),r=cf("WriteBatch.update",t,this.Hl),Fh(this.Hl.ql,"WriteBatch.update",r.Br,e,n,o)):(Su("WriteBatch.update",arguments,2),r=cf("WriteBatch.update",t,this.Hl),xh(this.Hl.ql,"WriteBatch.update",r.Br,e)),this.Xl=this.Xl.concat(i.Qr(r.Br,gs.exists(!0))),this},xl.prototype.delete=function(t){Su("WriteBatch.delete",arguments,1),this.Zl();var e=cf("WriteBatch.delete",t,this.Hl);return this.Xl=this.Xl.concat(new Fs(e.Br,gs.je())),this},xl.prototype.commit=function(){return this.Zl(),this.Jl=!0,0<this.Xl.length?this.Hl.$l().write(this.Xl):Promise.resolve()},xl.prototype.Zl=function(){if(this.Jl)throw new Yr(zr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},xl),Ul=(n(Ml,Vl=Sh),Ml.Kl=function(t,e,n){if(t.length%2!=0)throw new Yr(zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new Ml(new ti(t),e,n)},Object.defineProperty(Ml.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ml.prototype,"parent",{get:function(){return new rf(this.Br.path.g(),this.firestore,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(Ml.prototype,"path",{get:function(){return this.Br.path.$()},enumerable:!1,configurable:!0}),Ml.prototype.collection=function(t){if(Su("DocumentReference.collection",arguments,1),Lu("DocumentReference.collection","non-empty string",1,t),!t)throw new Yr(zr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Kr.N(t);return new rf(this.Br.path.child(e),this.firestore,null)},Ml.prototype.isEqual=function(t){if(!(t instanceof Ml))throw qu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Br.isEqual(t.Br)&&this.Wr===t.Wr},Ml.prototype.set=function(t,e){Ru("DocumentReference.set",arguments,1,2),e=af("DocumentReference.set",e);var n=lf(this.Wr,t,e),r=Mh(this.firestore.ql,"DocumentReference.set",this.Br,n,null!==this.Wr,e);return this.Nl.write(r.Qr(this.Br,gs.je()))},Ml.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Ku?(Du("DocumentReference.update",arguments,2),Fh(this.firestore.ql,"DocumentReference.update",this.Br,t,e,r)):(Su("DocumentReference.update",arguments,1),xh(this.firestore.ql,"DocumentReference.update",this.Br,t)),this.Nl.write(n.Qr(this.Br,gs.exists(!0)))},Ml.prototype.delete=function(){return Su("DocumentReference.delete",arguments,0),this.Nl.write([new Fs(this.Br,gs.je())])},Ml.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ru("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Al(i[a])||(ju("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),Vu("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u={includeMetadataChanges:s.includeMetadataChanges};if(Al(i[a])){var h=i[a];i[a]=null===(t=h.next)||void 0===t?void 0:t.bind(h),i[a+1]=null===(e=h.error)||void 0===e?void 0:e.bind(h),i[a+2]=null===(n=h.complete)||void 0===n?void 0:n.bind(h)}else Lu("DocumentReference.onSnapshot","function",a,i[a]),Ou("DocumentReference.onSnapshot","function",a+1,i[a+1]),Ou("DocumentReference.onSnapshot","function",a+2,i[a+2]);var c={next:function(t){i[a]&&i[a](r.t_(t))},error:i[a+1],complete:i[a+2]};return jl(this.Nl,this.Br,u,c)},Ml.prototype.get=function(t){var e,n,r,i,o,s=this;return Ru("DocumentReference.get",arguments,0,1),hf("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.$l().ml(this.Br).then(function(t){return new Gl(s.firestore,s.Br,t,!0,t instanceof Js&&t.Ge,s.Wr)}):(e=this.Nl,n=this.Br,r=t,i=new eu,o=jl(e,n,{includeMetadataChanges:!0,xu:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Yr(zr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Yr(zr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.t_(t)}))},Ml.prototype.withConverter=function(t){return new Ml(this.Br,this.firestore,t)},Ml.prototype.t_=function(t){var e=t.docs.get(this.Br);return new Gl(this.firestore,this.Br,e,t.fromCache,t.hasPendingWrites,this.Wr)},Ml);function Ml(t,e,n){var r=this;return(r=Vl.call(this,e.Ur,t,n)||this).Br=t,r.firestore=e,r.Wr=n,r.Nl=r.firestore.$l(),r}function xl(t){this.Hl=t,this.Xl=[],this.Jl=!1}function Fl(t,e){this.Hl=t,this.Yl=e}function jl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new ll({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(aa(e.path),o,n);return function(){o.Rl(),t.Uh(s)}}var ql,Bl=(Yl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Yl),Gl=(zl.prototype.data=function(t){var e=this;if(Ru("DocumentSnapshot.data",arguments,0,1),t=uf("DocumentSnapshot.data",t),this.e_){if(this.Wr){var n=new Wl(this.Hl,this.Br,this.e_,this.n_,this.s_,null);return this.Wr.fromFirestore(n,t)}return new Nl(this.Hl.Ur,this.Hl.zl(),t.serverTimestamps||"none",function(t){return new Ul(t,e.Hl,null)}).pl(this.e_.Ze())}},zl.prototype.get=function(t,e){var n=this;if(Ru("DocumentSnapshot.get",arguments,1,2),e=uf("DocumentSnapshot.get",e),this.e_){var r=this.e_.data().field(Hh("DocumentSnapshot.get",t,this.Br));if(null!==r)return new Nl(this.Hl.Ur,this.Hl.zl(),e.serverTimestamps||"none",function(t){return new Ul(t,n.Hl,n.Wr)}).pl(r)}},Object.defineProperty(zl.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"ref",{get:function(){return new Ul(this.Br,this.Hl,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"exists",{get:function(){return null!==this.e_},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"metadata",{get:function(){return new Bl(this.s_,this.n_)},enumerable:!1,configurable:!0}),zl.prototype.isEqual=function(t){if(!(t instanceof zl))throw qu("isEqual","DocumentSnapshot",1,t);return this.Hl===t.Hl&&this.n_===t.n_&&this.Br.isEqual(t.Br)&&(null===this.e_?null===t.e_:this.e_.isEqual(t.e_))&&this.Wr===t.Wr},zl),Wl=(n(Hl,ql=Gl),Hl.prototype.data=function(t){return ql.prototype.data.call(this,t)},Hl);function Hl(){return null!==ql&&ql.apply(this,arguments)||this}function zl(t,e,n,r,i,o){this.Hl=t,this.Br=e,this.e_=n,this.n_=r,this.s_=i,this.Wr=o}function Yl(t,e){this.hasPendingWrites=t,this.fromCache=e}function $l(t,e,n){if("string"==typeof n){if(""===n)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ua(e)&&-1!==n.indexOf("/"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Kr.N(n));if(!ti.W(r))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ao(t,new ti(r))}if(n instanceof Sh)return Ao(t,n.Br);throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+xu(n)+".")}function Xl(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function Ql(t,e,n){if(!n.isEqual(e))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Kl(t){if(t.an()&&0===t.tn.length)throw new Yr(zr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Jl=(Zl.prototype.where=function(t,e,n){Su("Query.where",arguments,3),Fu("Query.where",3,n);var r,i,o,s=Cu("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),a=Hh("Query.where",t),u=function(t,e,n,r,i,o,s){var a;if(i.L()){if("array-contains"===o||"array-contains-any"===o)throw new Yr(zr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){Xl(s,o);for(var u=[],h=0,c=s;h<c.length;h++){var l=c[h];u.push($l(r,t,l))}a={arrayValue:{values:u}}}else a=$l(r,t,s)}else"in"!==o&&"array-contains-any"!==o||Xl(s,o),a=jh(n,e,s,"in"===o);var f=ba.create(i,o,a);return function(t,e){if(e instanceof ba){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var a=t.un();null!==a&&Ql(0,e.field,a)}else if(o||i){var u=null;if(o&&(u=t._n(r)),null===u&&i&&(u=t._n(n)),null!==u)throw u===e.op?new Yr(zr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(zr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+u.toString()+"' filters.")}}}(t,f),f}(this.i_,"Query.where",this.firestore.ql,this.firestore.Ur,a,s,n);return new Zl((r=this.i_,i=u,o=r.filters.concat([i]),new oa(r.path,r.collectionGroup,r.tn.slice(),o,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},Zl.prototype.orderBy=function(t,e){var n;if(Ru("Query.orderBy",arguments,1,2),Ou("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yr(zr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o,s=Hh("Query.orderBy",t),a=function(t,e,n){if(null!==t.startAt)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new qa(e,n);return function(t,e){if(null===t.un()){var n=t.cn();null!==n&&Ql(0,n,e.field)}}(t,r),r}(this.i_,s,n);return new Zl((r=this.i_,i=a,o=r.tn.concat([i]),new oa(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},Zl.prototype.limit=function(t){return Su("Query.limit",arguments,1),Lu("Query.limit","number",1,t),Bu("Query.limit",1,t),new Zl(la(this.i_,t,"F"),this.firestore,this.Wr)},Zl.prototype.limitToLast=function(t){return Su("Query.limitToLast",arguments,1),Lu("Query.limitToLast","number",1,t),Bu("Query.limitToLast",1,t),new Zl(la(this.i_,t,"L"),this.firestore,this.Wr)},Zl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Du("Query.startAt",arguments,1);var r=this.r_("Query.startAt",t,e,!0);return new Zl(fa(this.i_,r),this.firestore,this.Wr)},Zl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Du("Query.startAfter",arguments,1);var r=this.r_("Query.startAfter",t,e,!1);return new Zl(fa(this.i_,r),this.firestore,this.Wr)},Zl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Du("Query.endBefore",arguments,1);var r=this.r_("Query.endBefore",t,e,!0);return new Zl(pa(this.i_,r),this.firestore,this.Wr)},Zl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Du("Query.endAt",arguments,1);var r=this.r_("Query.endAt",t,e,!1);return new Zl(pa(this.i_,r),this.firestore,this.Wr)},Zl.prototype.isEqual=function(t){if(!(t instanceof Zl))throw qu("isEqual","Query",1,t);return this.firestore===t.firestore&&da(this.i_,t.i_)&&this.Wr===t.Wr},Zl.prototype.withConverter=function(t){return new Zl(this.i_,this.firestore,t)},Zl.prototype.r_=function(t,e,n,r){if(Fu(t,1,e),e instanceof Gl)return Su(t,v([e],n),1),function(t,e,n,r,i){if(!r)throw new Yr(zr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=ha(t);s<a.length;s++){var u=a[s];if(u.field.L())o.push(Ao(e,r.key));else{var h=r.field(u.field);if(lo(h))throw new Yr(zr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===h){var c=u.field.$();throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}o.push(h)}}return new Pa(o,i)}(this.i_,this.firestore.Ur,t,e.e_,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Yr(zr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.L()){if("string"!=typeof h)throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!ua(t)&&-1!==h.indexOf("/"))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Kr.N(h));if(!ti.W(c))throw new Yr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ti(c);a.push(Ao(e,l))}else{var f=jh(n,r,h);a.push(f)}}return new Pa(a,o)}(this.i_,this.firestore.Ur,this.firestore.ql,t,i,r)},Zl.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ru("Query.onSnapshot",arguments,1,4);var s={},a=0;if("object"!=typeof i[a]||Al(i[a])||(ju("Query.onSnapshot",s=i[a],["includeMetadataChanges"]),Vu("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++),Al(i[a])){var u=i[a];i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)}else Lu("Query.onSnapshot","function",a,i[a]),Ou("Query.onSnapshot","function",a+1,i[a+1]),Ou("Query.onSnapshot","function",a+2,i[a+2]);var h={next:function(t){i[a]&&i[a](new nf(r.firestore,r.i_,t,r.Wr))},error:i[a+1],complete:i[a+2]};return Kl(this.i_),tf(this.firestore.$l(),this.i_,s,h)},Zl.prototype.get=function(t){var e=this;Ru("Query.get",arguments,0,1),hf("Query.get",t),Kl(this.i_);var n,r,i,o,s,a=this.firestore.$l();return(t&&"cache"===t.source?a.Il(this.i_):(n=a,r=this.i_,i=t,o=new eu,s=tf(n,r,{includeMetadataChanges:!0,xu:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Yr(zr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new nf(e.firestore,e.i_,t,e.Wr)})},Zl);function Zl(t,e,n){this.i_=t,this.firestore=e,this.Wr=n}function tf(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new ll({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Rl(),t.Uh(s)}}var ef,nf=(Object.defineProperty(sf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"empty",{get:function(){return this.h_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"size",{get:function(){return this.h_.docs.size},enumerable:!1,configurable:!0}),sf.prototype.forEach=function(e,n){var r=this;Ru("QuerySnapshot.forEach",arguments,1,2),Lu("QuerySnapshot.forEach","function",1,e),this.h_.docs.forEach(function(t){e.call(n,r.c_(t,r.metadata.fromCache,r.h_.Mt.has(t.key)))})},Object.defineProperty(sf.prototype,"query",{get:function(){return new Jl(this.o_,this.Hl,this.Wr)},enumerable:!1,configurable:!0}),sf.prototype.docChanges=function(t){t&&(ju("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Vu("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.h_.Ut)throw new Yr(zr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.a_&&this.u_===e||(this.a_=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.h_,e,this.c_.bind(this)),this.u_=e),this.a_},sf.prototype.isEqual=function(t){if(!(t instanceof sf))throw qu("isEqual","QuerySnapshot",1,t);return this.Hl===t.Hl&&da(this.o_,t.o_)&&this.h_.isEqual(t.h_)&&this.Wr===t.Wr},sf.prototype.c_=function(t,e,n){return new Wl(this.Hl,t.key,t,e,n,this.Wr)},sf),rf=(n(of,ef=Jl),Object.defineProperty(of.prototype,"id",{get:function(){return this.i_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(of.prototype,"parent",{get:function(){var t=this.i_.path.g();return t._()?null:new Ul(new ti(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(of.prototype,"path",{get:function(){return this.i_.path.$()},enumerable:!1,configurable:!0}),of.prototype.doc=function(t){Ru("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Pr.t()),Lu("CollectionReference.doc","non-empty string",1,t);var e=Kr.N(t);return Ul.Kl(this.i_.path.child(e),this.firestore,this.Wr)},of.prototype.add=function(t){Su("CollectionReference.add",arguments,1),Lu("CollectionReference.add","object",1,this.Wr?this.Wr.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},of.prototype.withConverter=function(t){return new of(this.l_,this.firestore,t)},of);function of(t,e,n){var r=this;if(((r=ef.call(this,aa(t),e,n)||this).l_=t).length%2!=1)throw new Yr(zr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function sf(t,e,n,r){this.Hl=t,this.o_=e,this.h_=n,this.Wr=r,this.a_=null,this.u_=null,this.metadata=new Bl(n.hasPendingWrites,n.fromCache)}function af(t,e){if(void 0===e)return{merge:!1};if(ju(t,e,["merge","mergeFields"]),Vu(t,"boolean","merge",e.merge),n=t,void 0!==(r=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+xu(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Yr(zr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+xu(n[i]))}(n,"mergeFields",r,function(t){return"string"==typeof t||t instanceof Ku}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(zr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,r;return e}function uf(t,e){return void 0===e?{}:(ju(t,e,["serverTimestamps"]),ku(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function hf(t,e){Ou(t,"object",1,e),e&&(ju(t,e,["source"]),ku(t,0,"source",e.source,["default","server","cache"]))}function cf(t,e,n){if(e instanceof Sh){if(e.firestore!==n)throw new Yr(zr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw qu(t,"DocumentReference",1,e)}function lf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ff,pf={Firestore:Dl,GeoPoint:gh,Timestamp:$r,Blob:Xu,Transaction:kl,WriteBatch:Cl,DocumentReference:Ul,DocumentSnapshot:Gl,Query:Jl,QueryDocumentSnapshot:Wl,QuerySnapshot:nf,CollectionReference:rf,FieldPath:Ku,FieldValue:yh,setLogLevel:Dl.setLogLevel,CACHE_SIZE_UNLIMITED:_l};(ff=df).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Dl(e,n,new hl);var e,n},"PUBLIC").setServiceProps(Object.assign({},pf))),ff.registerVersion("@firebase/firestore","1.16.1")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
